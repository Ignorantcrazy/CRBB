<?xml version="1.0" encoding="utf-8" ?>
<dataOperations xmlns="http://oversea.newegg.com/DataOperation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <!--申请，授权，有效数据表 T_PatentCase-->
  <dataCommand name="proc_PageQuery" database="MDATA" commandType="StoredProcedure">
    <commandText>
      <![CDATA[proc_PageQuery]]>
    </commandText>
    <parameters>
      <param name="@StartNumber" dbType="Int32" direction="Input"/>
      <param name="@EndNumber" dbType="Int32" direction="Input"/>
      <param name="@StrWhere" dbType="String" direction="Input"/>
      <param name="@LeftJoin" dbType="String" direction="Input"/>
      <param name="@TotalCount" dbType="Int32" direction="Output"/>
    </parameters>
  </dataCommand>

  <dataCommand name="proc_PageQuery2" database="MDATA2" commandType="StoredProcedure">
    <commandText>
      <![CDATA[proc_PageQuery]]>
    </commandText>
    <parameters>
      <param name="@StartNumber" dbType="Int32" direction="Input"/>
      <param name="@EndNumber" dbType="Int32" direction="Input"/>
      <param name="@StrWhere" dbType="String" direction="Input"/>
      <param name="@LeftJoin" dbType="String" direction="Input"/>
      <param name="@TotalCount" dbType="Int32" direction="Output"/>
    </parameters>
  </dataCommand>

  <dataCommand name="GetALL" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
     --1.查询当前查询条件的总行数
      SELECT @TotalCount = COUNT(A.Application_NO)
      FROM [dbo].[T_PatentCase] A 
      left join dbo.T_Applicants B on A.Application_NO=B.s_ApplicationNO
      --left join T_PatentStatus P on P.s_ApplicationNO=A.Application_NO
      --left join dbo.T_Agency G on G.s_NO=A.s_AgencyNO 
#StrWhere#   
     --2.使用top+ sql的内置行标识进行分页获取
     IF EXISTS  (SELECT  * FROM dbo.SysObjects WHERE ID = object_id(N'[#TD]') AND OBJECTPROPERTY(ID, 'IsTable') = 1) 
     BEGIN
		    DROP TABLE #TD   
	   END
     
     CREATE TABLE #TD
    (RowNumber BIGINT not null,n_ID BIGINT,s_ApplicantType CHAR(1),s_ApplicantName VARCHAR(200),n_Sequence INT,s_ApplicantSort CHAR(1))
   
   INSERT #TD
     SELECT RowNumber=ROW_NUMBER() OVER(ORDER BY A.n_ID DESC) 
				 ,A.n_ID  
         ,B.[s_ApplicantType]
         ,B.[s_Name] as s_ApplicantName
         ,B.[n_Sequence] as n_Sequence
         ,B.[s_ApplicantSort] as s_ApplicantSort   
	   FROM [dbo].[T_PatentCase] A 
       left join dbo.T_Applicants B on A.Application_NO=B.s_ApplicationNO
       --left join T_PatentStatus P on P.s_ApplicationNO=A.Application_NO
       --left join dbo.T_Agency G on G.s_NO=A.s_AgencyNO
       #StrWhere#   

CREATE NONCLUSTERED INDEX IX_TD_ROWNUM ON #TD(RowNumber)   

CREATE NONCLUSTERED INDEX IX_TD_ID ON #TD(n_ID)

SELECT A.[n_ID]
      ,Application_NO
      ,[s_PatentNO]
      ,[dt_ApplyDate]
      ,[dt_AuthorizeDate]
      ,[dt_OriAuthorizeDate]
      ,[s_PatentType]
      ,[s_ApplicantType]
      ,s_ApplicantName
      ,n_Sequence
      ,s_ApplicantSort
      ,[s_ProfessionCategory]
      ,[s_IndustryCategory]
      ,[s_LowStateTotal]
      ,[s_LowStateLevel1]
      ,[s_LowStateLevel2]
      ,[s_FailCause]
      ,[s_PatentName]
      ,[s_ContactorName]
      ,[s_ContactorTel]
      ,[s_ContactorZip]
      ,[s_ContactorAddr]
      ,[s_ContactorCountry]
      ,[s_ContactorProvince]
      ,[s_ContactorCity]
      ,[s_ContactorArea]
      ,[s_ReducedPayMk]
      ,[b_PriorityTF]
      ,[b_AgentTF]
      ,[s_AgencyNO]
      ,G.s_Name as s_AgencyName
      ,PV.PROVINCE_NAME as s_ProvinceName
      ,CT.CITY_NAME as s_CityName
      ,SUBSTRING(IPC.[s_IpcCategory],0,LEN(IPC.[s_IpcCategory])+1) as [s_IPC]
      ,[s_Agent_NO]
      ,[b_BranchTF]
      ,[s_OriApplicationNO]
      ,[dt_OriApplicationDate]
      ,[dt_OriApplicaDate]
      ,[b_PctTF]
      ,[n_ClaimItemNum]
      ,[b_ApplicantTransferTF]
      ,[s_ApplicantTransferTo]
      ,[b_IPRTransferTF]
      ,[s_IPRTransferTo]
      ,[s_CurrentOwner]
      ,[s_CityAward]
      ,[s_ProvinceAward]
      ,[s_CountryAward]
      ,A.[s_Remark]
      ,[b_PlanningDivisionTF]
      ,[b_ElectronicTF]
      ,[b_repeatedApp]
      ,[b_repeatedAut] 
      ,A.[n_InvalidTF]
      ,A.[dt_InvalidDate]
      ,A.[n_ValidYear]
      ,[dt_ValidDate]   
       FROM [dbo].[T_PatentCase] A 
       inner join #TD TD on TD.n_ID=A.n_ID
       left join T_PatentStatus P on P.s_ApplicationNO=A.Application_NO
       left join dbo.T_Agency G on G.s_NO=A.s_AgencyNO
       left join dbo.T_AddrProvince PV on PV.PROVINCE_CODE=G.s_Province
       left join T_AddrCity CT on CT.CITY_CODE=G.s_City and CT.PROVINCE_ID=G.s_Province  
       left join (SELECT s_ApplicationNo, 
STUFF(
     ( 
      SELECT ';'+ s_IpcCategory FROM T_IPCLocarno a WHERE b.s_ApplicationNo = a.s_ApplicationNo FOR XML PATH('')
     ),1 ,1, '') s_IpcCategory 
FROM T_IPCLocarno b 
GROUP BY s_ApplicationNo) as IPC on IPC.s_ApplicationNo=A.Application_NO  
WHERE RowNumber BETWEEN @StartNumber + 1 AND @EndNumber   

DROP TABLE #TD    
 
      ]]>
    </commandText>
  </dataCommand>
  <dataCommand name="GetALL2" database="MDATA2" commandType="Text">
    <commandText>
      <![CDATA[ 
     --1.查询当前查询条件的总行数
      SELECT @TotalCount = COUNT(A.Application_NO)
      FROM [dbo].[T_PatentCase] A 
      left join dbo.T_Applicants B on A.Application_NO=B.s_ApplicationNO
      --left join T_PatentStatus P on P.s_ApplicationNO=A.Application_NO
      --left join dbo.T_Agency G on G.s_NO=A.s_AgencyNO 
#StrWhere#
     --2.使用top+ sql的内置行标识进行分页获取
     IF EXISTS  (SELECT  * FROM dbo.SysObjects WHERE ID = object_id(N'[#TD]') AND OBJECTPROPERTY(ID, 'IsTable') = 1) 
     BEGIN
		    DROP TABLE #TD   
	   END 
     
     CREATE TABLE #TD
    (RowNumber BIGINT not null,n_ID BIGINT,s_ApplicantType CHAR(1),s_ApplicantName VARCHAR(200),n_Sequence INT,s_ApplicantSort CHAR(1))

     INSERT #TD
     SELECT RowNumber=ROW_NUMBER() OVER(ORDER BY A.n_ID DESC) 
				 ,A.n_ID
         ,B.[s_ApplicantType]
         ,B.[s_Name] as s_ApplicantName
         ,B.[n_Sequence] as n_Sequence
         ,B.[s_ApplicantSort] as s_ApplicantSort
	   FROM [dbo].[T_PatentCase] A 
       left join dbo.T_Applicants B on A.Application_NO=B.s_ApplicationNO
       --left join T_PatentStatus P on P.s_ApplicationNO=A.Application_NO
       --left join dbo.T_Agency G on G.s_NO=A.s_AgencyNO
       #StrWhere#   

CREATE NONCLUSTERED INDEX IX_TD_ROWNUM ON #TD(RowNumber)   

CREATE NONCLUSTERED INDEX IX_TD_ID ON #TD(n_ID)  

SELECT A.[n_ID]
      ,Application_NO
      ,[s_PatentNO]
      ,[dt_ApplyDate]
      ,[dt_AuthorizeDate]
      ,[dt_OriAuthorizeDate]
      ,[s_PatentType]
      ,[s_ApplicantType]
      ,s_ApplicantName
      ,n_Sequence
      ,s_ApplicantSort
      ,[s_ProfessionCategory]
      ,[s_IndustryCategory]
      ,[s_LowStateTotal]
      ,[s_LowStateLevel1]
      ,[s_LowStateLevel2]
      ,[s_FailCause]
      ,[s_PatentName]
      ,[s_ContactorName]
      ,[s_ContactorTel]
      ,[s_ContactorZip]
      ,[s_ContactorAddr]
      ,[s_ContactorCountry]
      ,[s_ContactorProvince]
      ,[s_ContactorCity]
      ,[s_ContactorArea]
      ,[s_ReducedPayMk]
      ,[b_PriorityTF]
      ,[b_AgentTF]
      ,[s_AgencyNO]
      ,G.s_Name as s_AgencyName
      ,PV.PROVINCE_NAME as s_ProvinceName
      ,CT.CITY_NAME as s_CityName
      ,SUBSTRING(IPC.[s_IpcCategory],0,LEN(IPC.[s_IpcCategory])+1) as [s_IPC]
      ,[s_Agent_NO]
      ,[b_BranchTF]
      ,[s_OriApplicationNO]
      ,[dt_OriApplicationDate]
      ,[dt_OriApplicaDate]
      ,[b_PctTF]
      ,[n_ClaimItemNum]
      ,[b_ApplicantTransferTF]
      ,[s_ApplicantTransferTo]
      ,[b_IPRTransferTF]
      ,[s_IPRTransferTo]
      ,[s_CurrentOwner]
      ,[s_CityAward]
      ,[s_ProvinceAward]
      ,[s_CountryAward]
      ,A.[s_Remark]
      ,[b_PlanningDivisionTF]
      ,[b_ElectronicTF]
      ,[b_repeatedApp]
      ,[b_repeatedAut] 
      ,A.[n_InvalidTF]
      ,A.[dt_InvalidDate]
      ,A.[n_ValidYear]
      ,[dt_ValidDate]   
       FROM [dbo].[T_PatentCase] A 
       inner join #TD TD on TD.n_ID=A.n_ID
       left join T_PatentStatus P on P.s_ApplicationNO=A.Application_NO
       left join dbo.T_Agency G on G.s_NO=A.s_AgencyNO
       left join dbo.T_AddrProvince PV on PV.PROVINCE_CODE=G.s_Province
       left join T_AddrCity CT on CT.CITY_CODE=G.s_City and CT.PROVINCE_ID=G.s_Province  
       left join (SELECT s_ApplicationNo, 
STUFF(
     ( 
      SELECT ';'+ s_IpcCategory FROM T_IPCLocarno a WHERE b.s_ApplicationNo = a.s_ApplicationNo FOR XML PATH('')
     ),1 ,1, '') s_IpcCategory 
FROM T_IPCLocarno b 
GROUP BY s_ApplicationNo) as IPC on IPC.s_ApplicationNo=A.Application_NO  
WHERE RowNumber BETWEEN @StartNumber + 1 AND @EndNumber   

DROP TABLE #TD    

      ]]>
    </commandText>
  </dataCommand>
  <dataCommand name="DeleteElectronicApplicationInfo" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
      DELETE [GDPA_One].[dbo].[T_PatentCase]
       WHERE  n_ID=@ID
      ]]>
    </commandText>
    <parameters>
      <param name="@ID" dbType="Int32" direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="InsertElectronicApplicationInfo" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
INSERT INTO [dbo].[T_PatentCase]
           ([Application_NO]
           ,[s_PatentNO]
           ,[s_PatentType]
           ,[s_ProfessionCategory]
           ,[s_IndustryCategory]
           ,[s_LowStateTotal]
           ,[s_LowStateLevel1]
           ,[s_LowStateLevel2]
           ,[s_FailCause]
           ,[s_PatentName]
           ,[s_ContactorName]
           ,[s_ContactorTel]
           ,[s_ContactorZip]
           ,[s_ContactorAddr]
           ,[s_ContactorCountry]
           ,[s_ContactorProvince]
           ,[s_ContactorCity]
           ,[s_ContactorArea]
           ,[s_ReducedPayMk]
           ,[b_PriorityTF]
           ,[b_AgentTF]
           ,[s_AgencyNO]
           ,[s_Agent_NO]
           ,[b_BranchTF]
           ,[s_OriApplicationNO]
           ,[dt_OriApplicationDate]
           ,[b_PctTF]
           ,[n_ClaimItemNum]
           ,[b_ApplicantTransferTF]
           ,[s_ApplicantTransferTo]
           ,[b_IPRTransferTF]
           ,[s_IPRTransferTo]
           ,[s_CurrentOwner]
           ,[s_CityAward]
           ,[s_ProvinceAward]
           ,[s_CountryAward]
           ,[s_Remark]
           ,[b_PlanningDivisionTF]
           ,[b_ElectronicTF]
           ,[b_repeatedApp]
           ,[b_repeatedAut]
           ,[n_InvalidTF]
           ,[dt_InvalidDate]
           ,[n_ValidYear]
           ,[dt_ValidDate])
     VALUES
          (@Application_NO 
           ,@s_PatentNO 
           ,@s_PatentType 
           ,@s_ProfessionCategory 
           ,@s_IndustryCategory 
           ,@s_LowStateTotal 
           ,@s_LowStateLevel1 
           ,@s_LowStateLevel2
           ,@s_FailCause
           ,@s_PatentName 
           ,@s_ContactorName
           ,@s_ContactorTel 
           ,@s_ContactorZip
           ,@s_ContactorAddr 
           ,@s_ContactorCountry 
           ,@s_ContactorProvince 
           ,@s_ContactorCity 
           ,@s_ContactorArea 
           ,@s_ReducedPayMk 
           ,@b_PriorityTF 
           ,@b_AgentTF 
           ,@s_AgencyNO 
           ,@s_Agent_NO 
           ,@b_BranchTF 
           ,@s_OriApplicationNO 
           ,@dt_OriApplicationDate 
           ,@b_PctTF 
           ,@n_ClaimItemNum 
           ,@b_ApplicantTransferTF 
           ,@s_ApplicantTransferTo
           ,@b_IPRTransferTF 
           ,@s_IPRTransferTo 
           ,@s_CurrentOwner
           ,@s_CityAward
           ,@s_ProvinceAward 
           ,@s_CountryAward 
           ,@s_Remark
           ,@b_PlanningDivisionTF
           ,@b_ElectronicTF
           ,@b_repeatedApp
           ,@b_repeatedAut
           ,@n_InvalidTF
           ,@dt_InvalidDate
           ,@n_ValidYear
           ,@dt_ValidDate)
          SELECT SCOPE_IDENTITY();
      ]]>
    </commandText>
    <parameters>
      <param name="@Application_NO" dbType="String"  direction="Input"/>
      <param name="@s_PatentNO" dbType="String"  direction="Input"/>
      <param name="@s_PatentType" dbType="String"  direction="Input"/>
      <param name="@s_ProfessionCategory" dbType="String"  direction="Input"/>
      <param name="@s_IndustryCategory" dbType="String"  direction="Input"/>

      <param name="@s_LowStateTotal" dbType="String"  direction="Input"/>
      <param name="@s_LowStateLevel1" dbType="String"  direction="Input"/>
      <param name="@s_LowStateLevel2" dbType="String"  direction="Input"/>
      <param name="@s_FailCause" dbType="String"  direction="Input"/>
      <param name="@s_PatentName" dbType="String"  direction="Input"/>

      <param name="@s_ContactorName" dbType="String"  direction="Input"/>
      <param name="@s_ContactorTel" dbType="String"  direction="Input"/>
      <param name="@s_ContactorZip" dbType="String"  direction="Input"/>
      <param name="@s_ContactorAddr" dbType="String"  direction="Input"/>
      <param name="@s_ContactorCountry" dbType="String"  direction="Input"/>

      <param name="@s_ContactorProvince" dbType="String"  direction="Input"/>
      <param name="@s_ContactorCity" dbType="String"  direction="Input"/>
      <param name="@s_ContactorArea" dbType="String"  direction="Input"/>
      <param name="@s_ReducedPayMk" dbType="String"  direction="Input"/>
      <param name="@b_PriorityTF" dbType="String"  direction="Input"/>

      <param name="@b_AgentTF" dbType="String"  direction="Input"/>
      <param name="@s_AgencyNO" dbType="String"  direction="Input"/>
      <param name="@s_Agent_NO" dbType="String"  direction="Input"/>
      <param name="@b_BranchTF" dbType="String"  direction="Input"/>
      <param name="@s_OriApplicationNO" dbType="String"  direction="Input"/>

      <param name="@dt_OriApplicationDate" dbType="DateTime"  direction="Input"/>
      <param name="@b_PctTF" dbType="String"  direction="Input"/>
      <param name="@n_ClaimItemNum" dbType="Int32"  direction="Input"/>
      <param name="@b_ApplicantTransferTF" dbType="String"  direction="Input"/>
      <param name="@s_ApplicantTransferTo" dbType="String"  direction="Input"/>

      <param name="@b_IPRTransferTF" dbType="String"  direction="Input"/>
      <param name="@s_IPRTransferTo" dbType="String"  direction="Input"/>
      <param name="@s_CurrentOwner" dbType="String"  direction="Input"/>
      <param name="@s_CityAward" dbType="String"  direction="Input"/>
      <param name="@s_ProvinceAward" dbType="String"  direction="Input"/>

      <param name="@s_CountryAward" dbType="String"  direction="Input"/>
      <param name="@s_Remark" dbType="String"  direction="Input"/>
      <param name="@b_PlanningDivisionTF" dbType="String"  direction="Input"/>
      <param name="@b_ElectronicTF" dbType="String"  direction="Input"/>

      <param name="@b_repeatedApp" dbType="String"  direction="Input"/>
      <param name="@b_repeatedAut" dbType="String"  direction="Input"/>

      <param name="@n_InvalidTF" dbType="String"  direction="Input"/>
      <param name="@dt_InvalidDate" dbType="DateTime"  direction="Input"/>
      <param name="@n_ValidYear" dbType="Int32"  direction="Input"/>

      <param name="@dt_ValidDate" dbType="DateTime"  direction="Input"/>

    </parameters>
  </dataCommand>
  <dataCommand name="InsertElectronicApplicationSQ" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
INSERT INTO [dbo].[T_PatentCase]
           ([Application_NO]
           ,[s_PatentNO]
           ,[s_PatentType]
           ,[s_ProfessionCategory]
           ,[s_IndustryCategory]
           ,[s_LowStateTotal]
           ,[s_LowStateLevel1]
           ,[s_LowStateLevel2]
           ,[s_FailCause]
           ,[s_PatentName]
           ,[s_ContactorName]
           ,[s_ContactorTel]
           ,[s_ContactorZip]
           ,[s_ContactorAddr]
           ,[s_ContactorCountry]
           ,[s_ContactorProvince]
           ,[s_ContactorCity]
           ,[s_ContactorArea]
           ,[s_ReducedPayMk]
           ,[b_PriorityTF]
           ,[b_AgentTF]
           ,[s_AgencyNO]
           ,[s_Agent_NO]
           ,[b_BranchTF]
           ,[s_OriApplicationNO]
           ,[dt_OriApplicationDate]
           ,[b_PctTF]
           ,[n_ClaimItemNum]
           ,[b_ApplicantTransferTF]
           ,[s_ApplicantTransferTo]
           ,[b_IPRTransferTF]
           ,[s_IPRTransferTo]
           ,[s_CurrentOwner]
           ,[s_CityAward]
           ,[s_ProvinceAward]
           ,[s_CountryAward]
           ,[s_Remark]
           ,[b_PlanningDivisionTF]
           ,[b_ElectronicTF]
           ,[b_repeatedApp]
           ,[b_repeatedAut])
     VALUES
          (@Application_NO 
           ,@s_PatentNO 
           ,@s_PatentType 
           ,@s_ProfessionCategory 
           ,@s_IndustryCategory 
           ,@s_LowStateTotal 
           ,@s_LowStateLevel1 
           ,@s_LowStateLevel2
           ,@s_FailCause
           ,@s_PatentName 
           ,@s_ContactorName
           ,@s_ContactorTel 
           ,@s_ContactorZip
           ,@s_ContactorAddr 
           ,@s_ContactorCountry 
           ,@s_ContactorProvince 
           ,@s_ContactorCity 
           ,@s_ContactorArea 
           ,@s_ReducedPayMk 
           ,@b_PriorityTF 
           ,@b_AgentTF 
           ,@s_AgencyNO 
           ,@s_Agent_NO 
           ,@b_BranchTF 
           ,@s_OriApplicationNO 
           ,@dt_OriApplicationDate 
           ,@b_PctTF 
           ,@n_ClaimItemNum 
           ,@b_ApplicantTransferTF 
           ,@s_ApplicantTransferTo
           ,@b_IPRTransferTF 
           ,@s_IPRTransferTo 
           ,@s_CurrentOwner
           ,@s_CityAward
           ,@s_ProvinceAward 
           ,@s_CountryAward 
           ,@s_Remark
           ,@b_PlanningDivisionTF
           ,@b_ElectronicTF
           ,@b_repeatedApp
           ,@b_repeatedAut)
          SELECT SCOPE_IDENTITY();
      ]]>
    </commandText>
    <parameters>
      <param name="@Application_NO" dbType="String"  direction="Input"/>
      <param name="@s_PatentNO" dbType="String"  direction="Input"/>
      <param name="@s_PatentType" dbType="String"  direction="Input"/>
      <param name="@s_ProfessionCategory" dbType="String"  direction="Input"/>
      <param name="@s_IndustryCategory" dbType="String"  direction="Input"/>

      <param name="@s_LowStateTotal" dbType="String"  direction="Input"/>
      <param name="@s_LowStateLevel1" dbType="String"  direction="Input"/>
      <param name="@s_LowStateLevel2" dbType="String"  direction="Input"/>
      <param name="@s_FailCause" dbType="String"  direction="Input"/>
      <param name="@s_PatentName" dbType="String"  direction="Input"/>

      <param name="@s_ContactorName" dbType="String"  direction="Input"/>
      <param name="@s_ContactorTel" dbType="String"  direction="Input"/>
      <param name="@s_ContactorZip" dbType="String"  direction="Input"/>
      <param name="@s_ContactorAddr" dbType="String"  direction="Input"/>
      <param name="@s_ContactorCountry" dbType="String"  direction="Input"/>

      <param name="@s_ContactorProvince" dbType="String"  direction="Input"/>
      <param name="@s_ContactorCity" dbType="String"  direction="Input"/>
      <param name="@s_ContactorArea" dbType="String"  direction="Input"/>
      <param name="@s_ReducedPayMk" dbType="String"  direction="Input"/>
      <param name="@b_PriorityTF" dbType="String"  direction="Input"/>

      <param name="@b_AgentTF" dbType="String"  direction="Input"/>
      <param name="@s_AgencyNO" dbType="String"  direction="Input"/>
      <param name="@s_Agent_NO" dbType="String"  direction="Input"/>
      <param name="@b_BranchTF" dbType="String"  direction="Input"/>
      <param name="@s_OriApplicationNO" dbType="String"  direction="Input"/>

      <param name="@dt_OriApplicationDate" dbType="DateTime"  direction="Input"/>
      <param name="@b_PctTF" dbType="String"  direction="Input"/>
      <param name="@n_ClaimItemNum" dbType="Int32"  direction="Input"/>
      <param name="@b_ApplicantTransferTF" dbType="String"  direction="Input"/>
      <param name="@s_ApplicantTransferTo" dbType="String"  direction="Input"/>

      <param name="@b_IPRTransferTF" dbType="String"  direction="Input"/>
      <param name="@s_IPRTransferTo" dbType="String"  direction="Input"/>
      <param name="@s_CurrentOwner" dbType="String"  direction="Input"/>
      <param name="@s_CityAward" dbType="String"  direction="Input"/>
      <param name="@s_ProvinceAward" dbType="String"  direction="Input"/>

      <param name="@s_CountryAward" dbType="String"  direction="Input"/>
      <param name="@s_Remark" dbType="String"  direction="Input"/>
      <param name="@b_PlanningDivisionTF" dbType="String"  direction="Input"/>
      <param name="@b_ElectronicTF" dbType="String"  direction="Input"/>

      <param name="@b_repeatedApp" dbType="String"  direction="Input"/>
      <param name="@b_repeatedAut" dbType="String"  direction="Input"/>

    </parameters>
  </dataCommand>
  <dataCommand name="InsertElectronicApplicationSQ2" database="MDATA2" commandType="Text">
    <commandText>
      <![CDATA[ 
INSERT INTO [dbo].[T_PatentCase]
           ([Application_NO]
           ,[s_PatentNO]
           ,[s_PatentType]
           ,[s_ProfessionCategory]
           ,[s_IndustryCategory]
           ,[s_LowStateTotal]
           ,[s_LowStateLevel1]
           ,[s_LowStateLevel2]
           ,[s_FailCause]
           ,[s_PatentName]
           ,[s_ContactorName]
           ,[s_ContactorTel]
           ,[s_ContactorZip]
           ,[s_ContactorAddr]
           ,[s_ContactorCountry]
           ,[s_ContactorProvince]
           ,[s_ContactorCity]
           ,[s_ContactorArea]
           ,[s_ReducedPayMk]
           ,[b_PriorityTF]
           ,[b_AgentTF]
           ,[s_AgencyNO]
           ,[s_Agent_NO]
           ,[b_BranchTF]
           ,[s_OriApplicationNO]
           ,[dt_OriApplicationDate]
           ,[b_PctTF]
           ,[n_ClaimItemNum]
           ,[b_ApplicantTransferTF]
           ,[s_ApplicantTransferTo]
           ,[b_IPRTransferTF]
           ,[s_IPRTransferTo]
           ,[s_CurrentOwner]
           ,[s_CityAward]
           ,[s_ProvinceAward]
           ,[s_CountryAward]
           ,[s_Remark]
           ,[b_PlanningDivisionTF]
           ,[b_ElectronicTF]
           ,[b_repeatedApp]
           ,[b_repeatedAut])
     VALUES
          (@Application_NO 
           ,@s_PatentNO 
           ,@s_PatentType 
           ,@s_ProfessionCategory 
           ,@s_IndustryCategory 
           ,@s_LowStateTotal 
           ,@s_LowStateLevel1 
           ,@s_LowStateLevel2
           ,@s_FailCause
           ,@s_PatentName 
           ,@s_ContactorName
           ,@s_ContactorTel 
           ,@s_ContactorZip
           ,@s_ContactorAddr 
           ,@s_ContactorCountry 
           ,@s_ContactorProvince 
           ,@s_ContactorCity 
           ,@s_ContactorArea 
           ,@s_ReducedPayMk 
           ,@b_PriorityTF 
           ,@b_AgentTF 
           ,@s_AgencyNO 
           ,@s_Agent_NO 
           ,@b_BranchTF 
           ,@s_OriApplicationNO 
           ,@dt_OriApplicationDate 
           ,@b_PctTF 
           ,@n_ClaimItemNum 
           ,@b_ApplicantTransferTF 
           ,@s_ApplicantTransferTo
           ,@b_IPRTransferTF 
           ,@s_IPRTransferTo 
           ,@s_CurrentOwner
           ,@s_CityAward
           ,@s_ProvinceAward 
           ,@s_CountryAward 
           ,@s_Remark
           ,@b_PlanningDivisionTF
           ,@b_ElectronicTF
           ,@b_repeatedApp
           ,@b_repeatedAut)
          SELECT SCOPE_IDENTITY();
      ]]>
    </commandText>
    <parameters>
      <param name="@Application_NO" dbType="String"  direction="Input"/>
      <param name="@s_PatentNO" dbType="String"  direction="Input"/>
      <param name="@s_PatentType" dbType="String"  direction="Input"/>
      <param name="@s_ProfessionCategory" dbType="String"  direction="Input"/>
      <param name="@s_IndustryCategory" dbType="String"  direction="Input"/>

      <param name="@s_LowStateTotal" dbType="String"  direction="Input"/>
      <param name="@s_LowStateLevel1" dbType="String"  direction="Input"/>
      <param name="@s_LowStateLevel2" dbType="String"  direction="Input"/>
      <param name="@s_FailCause" dbType="String"  direction="Input"/>
      <param name="@s_PatentName" dbType="String"  direction="Input"/>

      <param name="@s_ContactorName" dbType="String"  direction="Input"/>
      <param name="@s_ContactorTel" dbType="String"  direction="Input"/>
      <param name="@s_ContactorZip" dbType="String"  direction="Input"/>
      <param name="@s_ContactorAddr" dbType="String"  direction="Input"/>
      <param name="@s_ContactorCountry" dbType="String"  direction="Input"/>

      <param name="@s_ContactorProvince" dbType="String"  direction="Input"/>
      <param name="@s_ContactorCity" dbType="String"  direction="Input"/>
      <param name="@s_ContactorArea" dbType="String"  direction="Input"/>
      <param name="@s_ReducedPayMk" dbType="String"  direction="Input"/>
      <param name="@b_PriorityTF" dbType="String"  direction="Input"/>

      <param name="@b_AgentTF" dbType="String"  direction="Input"/>
      <param name="@s_AgencyNO" dbType="String"  direction="Input"/>
      <param name="@s_Agent_NO" dbType="String"  direction="Input"/>
      <param name="@b_BranchTF" dbType="String"  direction="Input"/>
      <param name="@s_OriApplicationNO" dbType="String"  direction="Input"/>

      <param name="@dt_OriApplicationDate" dbType="DateTime"  direction="Input"/>
      <param name="@b_PctTF" dbType="String"  direction="Input"/>
      <param name="@n_ClaimItemNum" dbType="Int32"  direction="Input"/>
      <param name="@b_ApplicantTransferTF" dbType="String"  direction="Input"/>
      <param name="@s_ApplicantTransferTo" dbType="String"  direction="Input"/>

      <param name="@b_IPRTransferTF" dbType="String"  direction="Input"/>
      <param name="@s_IPRTransferTo" dbType="String"  direction="Input"/>
      <param name="@s_CurrentOwner" dbType="String"  direction="Input"/>
      <param name="@s_CityAward" dbType="String"  direction="Input"/>
      <param name="@s_ProvinceAward" dbType="String"  direction="Input"/>

      <param name="@s_CountryAward" dbType="String"  direction="Input"/>
      <param name="@s_Remark" dbType="String"  direction="Input"/>
      <param name="@b_PlanningDivisionTF" dbType="String"  direction="Input"/>
      <param name="@b_ElectronicTF" dbType="String"  direction="Input"/>

      <param name="@b_repeatedApp" dbType="String"  direction="Input"/>
      <param name="@b_repeatedAut" dbType="String"  direction="Input"/>

    </parameters>
  </dataCommand>
  <dataCommand name="InsertElectronicApplicationInfo2" database="MDATA2" commandType="Text">
    <commandText>
      <![CDATA[ 
INSERT INTO [dbo].[T_PatentCase]
           ([Application_NO]
           ,[s_PatentNO]
           ,[s_PatentType]
           ,[s_ProfessionCategory]
           ,[s_IndustryCategory]
           ,[s_LowStateTotal]
           ,[s_LowStateLevel1]
           ,[s_LowStateLevel2]
           ,[s_FailCause]
           ,[s_PatentName]
           ,[s_ContactorName]
           ,[s_ContactorTel]
           ,[s_ContactorZip]
           ,[s_ContactorAddr]
           ,[s_ContactorCountry]
           ,[s_ContactorProvince]
           ,[s_ContactorCity]
           ,[s_ContactorArea]
           ,[s_ReducedPayMk]
           ,[b_PriorityTF]
           ,[b_AgentTF]
           ,[s_AgencyNO]
           ,[s_Agent_NO]
           ,[b_BranchTF]
           ,[s_OriApplicationNO]
           ,[dt_OriApplicationDate]
           ,[b_PctTF]
           ,[n_ClaimItemNum]
           ,[b_ApplicantTransferTF]
           ,[s_ApplicantTransferTo]
           ,[b_IPRTransferTF]
           ,[s_IPRTransferTo]
           ,[s_CurrentOwner]
           ,[s_CityAward]
           ,[s_ProvinceAward]
           ,[s_CountryAward]
           ,[s_Remark]
           ,[b_PlanningDivisionTF]
           ,[b_ElectronicTF]
           ,[b_repeatedApp]
           ,[b_repeatedAut]
           ,[n_InvalidTF]
           ,[dt_InvalidDate]
           ,[n_ValidYear]
           ,[dt_ValidDate])
     VALUES
          (@Application_NO 
           ,@s_PatentNO 
           ,@s_PatentType 
           ,@s_ProfessionCategory 
           ,@s_IndustryCategory 
           ,@s_LowStateTotal 
           ,@s_LowStateLevel1 
           ,@s_LowStateLevel2
           ,@s_FailCause
           ,@s_PatentName 
           ,@s_ContactorName
           ,@s_ContactorTel 
           ,@s_ContactorZip
           ,@s_ContactorAddr 
           ,@s_ContactorCountry 
           ,@s_ContactorProvince 
           ,@s_ContactorCity 
           ,@s_ContactorArea 
           ,@s_ReducedPayMk 
           ,@b_PriorityTF 
           ,@b_AgentTF 
           ,@s_AgencyNO 
           ,@s_Agent_NO 
           ,@b_BranchTF 
           ,@s_OriApplicationNO 
           ,@dt_OriApplicationDate 
           ,@b_PctTF 
           ,@n_ClaimItemNum 
           ,@b_ApplicantTransferTF 
           ,@s_ApplicantTransferTo
           ,@b_IPRTransferTF 
           ,@s_IPRTransferTo 
           ,@s_CurrentOwner
           ,@s_CityAward
           ,@s_ProvinceAward 
           ,@s_CountryAward 
           ,@s_Remark
           ,@b_PlanningDivisionTF
           ,@b_ElectronicTF
           ,@b_repeatedApp
           ,@b_repeatedAut
           ,@n_InvalidTF
           ,@dt_InvalidDate
           ,@n_ValidYear
           ,@dt_ValidDate)
          SELECT SCOPE_IDENTITY();
      ]]>
    </commandText>
    <parameters>
      <param name="@Application_NO" dbType="String"  direction="Input"/>
      <param name="@s_PatentNO" dbType="String"  direction="Input"/>
      <param name="@s_PatentType" dbType="String"  direction="Input"/>
      <param name="@s_ProfessionCategory" dbType="String"  direction="Input"/>
      <param name="@s_IndustryCategory" dbType="String"  direction="Input"/>

      <param name="@s_LowStateTotal" dbType="String"  direction="Input"/>
      <param name="@s_LowStateLevel1" dbType="String"  direction="Input"/>
      <param name="@s_LowStateLevel2" dbType="String"  direction="Input"/>
      <param name="@s_FailCause" dbType="String"  direction="Input"/>
      <param name="@s_PatentName" dbType="String"  direction="Input"/>

      <param name="@s_ContactorName" dbType="String"  direction="Input"/>
      <param name="@s_ContactorTel" dbType="String"  direction="Input"/>
      <param name="@s_ContactorZip" dbType="String"  direction="Input"/>
      <param name="@s_ContactorAddr" dbType="String"  direction="Input"/>
      <param name="@s_ContactorCountry" dbType="String"  direction="Input"/>

      <param name="@s_ContactorProvince" dbType="String"  direction="Input"/>
      <param name="@s_ContactorCity" dbType="String"  direction="Input"/>
      <param name="@s_ContactorArea" dbType="String"  direction="Input"/>
      <param name="@s_ReducedPayMk" dbType="String"  direction="Input"/>
      <param name="@b_PriorityTF" dbType="String"  direction="Input"/>

      <param name="@b_AgentTF" dbType="String"  direction="Input"/>
      <param name="@s_AgencyNO" dbType="String"  direction="Input"/>
      <param name="@s_Agent_NO" dbType="String"  direction="Input"/>
      <param name="@b_BranchTF" dbType="String"  direction="Input"/>
      <param name="@s_OriApplicationNO" dbType="String"  direction="Input"/>

      <param name="@dt_OriApplicationDate" dbType="DateTime"  direction="Input"/>
      <param name="@b_PctTF" dbType="String"  direction="Input"/>
      <param name="@n_ClaimItemNum" dbType="Int32"  direction="Input"/>
      <param name="@b_ApplicantTransferTF" dbType="String"  direction="Input"/>
      <param name="@s_ApplicantTransferTo" dbType="String"  direction="Input"/>

      <param name="@b_IPRTransferTF" dbType="String"  direction="Input"/>
      <param name="@s_IPRTransferTo" dbType="String"  direction="Input"/>
      <param name="@s_CurrentOwner" dbType="String"  direction="Input"/>
      <param name="@s_CityAward" dbType="String"  direction="Input"/>
      <param name="@s_ProvinceAward" dbType="String"  direction="Input"/>

      <param name="@s_CountryAward" dbType="String"  direction="Input"/>
      <param name="@s_Remark" dbType="String"  direction="Input"/>
      <param name="@b_PlanningDivisionTF" dbType="String"  direction="Input"/>
      <param name="@b_ElectronicTF" dbType="String"  direction="Input"/>

      <param name="@b_repeatedApp" dbType="String"  direction="Input"/>
      <param name="@b_repeatedAut" dbType="String"  direction="Input"/>

      <param name="@n_InvalidTF" dbType="String"  direction="Input"/>
      <param name="@dt_InvalidDate" dbType="DateTime"  direction="Input"/>
      <param name="@n_ValidYear" dbType="Int32"  direction="Input"/>

      <param name="@dt_ValidDate" dbType="DateTime"  direction="Input"/>

    </parameters>
  </dataCommand>
  <dataCommand name="GetGDPAElectronicApplicationByAppNO" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
SELECT [n_ID]
      ,[Application_NO]
      ,[s_PatentNO]
      ,[s_PatentType]
      ,[s_ProfessionCategory]
      ,[s_IndustryCategory]
      ,[s_LowStateTotal]
      ,[s_LowStateLevel1]
      ,[s_LowStateLevel2]
      ,[s_FailCause]
      ,[s_PatentName]
      ,[s_ContactorName]
      ,[s_ContactorTel]
      ,[s_ContactorZip]
      ,[s_ContactorAddr]
      ,[s_ContactorCountry]
      ,[s_ContactorProvince]
      ,[s_ContactorCity]
      ,[s_ContactorArea]
      ,[s_ReducedPayMk]
      ,[b_PriorityTF]
      ,[b_AgentTF]
      ,[s_AgencyNO]
      ,[s_Agent_NO]
      ,[b_BranchTF]
      ,[s_OriApplicationNO]
      ,[dt_OriApplicationDate]
      ,[b_PctTF]
      ,[n_ClaimItemNum]
      ,[b_ApplicantTransferTF]
      ,[s_ApplicantTransferTo]
      ,[b_IPRTransferTF]
      ,[s_IPRTransferTo]
      ,[s_CurrentOwner]
      ,[s_CityAward]
      ,[s_ProvinceAward]
      ,[s_CountryAward]
      ,[s_Remark]
      ,[b_PlanningDivisionTF]
      ,[b_ElectronicTF]
      ,[b_repeatedApp]
      ,[b_repeatedAut]
      ,[dt_ValidDate] 
  FROM [dbo].[T_PatentCase] WITH(NOLOCK)
      WHERE Application_NO=@ApplicationNo
      ]]>
    </commandText>
    <parameters>
      <param name="@ApplicationNo" dbType="AnsiStringFixedLength" direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="GetGDPAElectronicApplicationByAppNO2" database="MDATA2" commandType="Text">
    <commandText>
      <![CDATA[ 
SELECT [n_ID]
      ,[Application_NO]
      ,[s_PatentNO]
      ,[s_PatentType]
      ,[s_ProfessionCategory]
      ,[s_IndustryCategory]
      ,[s_LowStateTotal]
      ,[s_LowStateLevel1]
      ,[s_LowStateLevel2]
      ,[s_FailCause]
      ,[s_PatentName]
      ,[s_ContactorName]
      ,[s_ContactorTel]
      ,[s_ContactorZip]
      ,[s_ContactorAddr]
      ,[s_ContactorCountry]
      ,[s_ContactorProvince]
      ,[s_ContactorCity]
      ,[s_ContactorArea]
      ,[s_ReducedPayMk]
      ,[b_PriorityTF]
      ,[b_AgentTF]
      ,[s_AgencyNO]
      ,[s_Agent_NO]
      ,[b_BranchTF]
      ,[s_OriApplicationNO]
      ,[dt_OriApplicationDate]
      ,[b_PctTF]
      ,[n_ClaimItemNum]
      ,[b_ApplicantTransferTF]
      ,[s_ApplicantTransferTo]
      ,[b_IPRTransferTF]
      ,[s_IPRTransferTo]
      ,[s_CurrentOwner]
      ,[s_CityAward]
      ,[s_ProvinceAward]
      ,[s_CountryAward]
      ,[s_Remark]
      ,[b_PlanningDivisionTF]
      ,[b_ElectronicTF]
      ,[b_repeatedApp]
      ,[b_repeatedAut]
      ,[dt_ValidDate] 
  FROM [dbo].[T_PatentCase] WITH(NOLOCK)
      WHERE Application_NO=@ApplicationNo
      ]]>
    </commandText>
    <parameters>
      <param name="@ApplicationNo" dbType="AnsiStringFixedLength" direction="Input"/>
    </parameters>
  </dataCommand>
  <!--获取所有有效数据-->
  <dataCommand name="GetGDPAAllValidApplications" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
SELECT [n_ID]
      ,[Application_NO]
      ,[s_PatentNO]
      ,[s_PatentType]
      ,[s_ProfessionCategory]
      ,[s_IndustryCategory]
      ,[s_LowStateTotal]
      ,[s_LowStateLevel1]
      ,[s_LowStateLevel2]
      ,[s_FailCause]
      ,[s_PatentName]
      ,[s_ContactorName]
      ,[s_ContactorTel]
      ,[s_ContactorZip]
      ,[s_ContactorAddr]
      ,[s_ContactorCountry]
      ,[s_ContactorProvince]
      ,[s_ContactorCity]
      ,[s_ContactorArea]
      ,[s_ReducedPayMk]
      ,[b_PriorityTF]
      ,[b_AgentTF]
      ,[s_AgencyNO]
      ,[s_Agent_NO]
      ,[b_BranchTF]
      ,[s_OriApplicationNO]
      ,[dt_OriApplicationDate]
      ,[b_PctTF]
      ,[n_ClaimItemNum]
      ,[b_ApplicantTransferTF]
      ,[s_ApplicantTransferTo]
      ,[b_IPRTransferTF]
      ,[s_IPRTransferTo]
      ,[s_CurrentOwner]
      ,[s_CityAward]
      ,[s_ProvinceAward]
      ,[s_CountryAward]
      ,[s_Remark]
      ,[b_PlanningDivisionTF]
      ,[b_ElectronicTF]
      ,[n_InvalidTF]
      ,[dt_InvalidDate]
      ,[b_repeatedApp]
      ,[b_repeatedAut]
      ,[n_ValidYear]
      ,[dt_ValidDate]   
  FROM [dbo].[T_PatentCase] WITH(NOLOCK)  
  WHERE n_InvalidTF = 1   
      ]]>
    </commandText>
  </dataCommand>
  <dataCommand name="GetGDPAAllValidApplications2" database="MDATA2" commandType="Text">
    <commandText>
      <![CDATA[ 
SELECT [n_ID]
      ,[Application_NO]
      ,[s_PatentNO]
      ,[s_PatentType]
      ,[s_ProfessionCategory]
      ,[s_IndustryCategory]
      ,[s_LowStateTotal]
      ,[s_LowStateLevel1]
      ,[s_LowStateLevel2]
      ,[s_FailCause]
      ,[s_PatentName]
      ,[s_ContactorName]
      ,[s_ContactorTel]
      ,[s_ContactorZip]
      ,[s_ContactorAddr]
      ,[s_ContactorCountry]
      ,[s_ContactorProvince]
      ,[s_ContactorCity]
      ,[s_ContactorArea]
      ,[s_ReducedPayMk]
      ,[b_PriorityTF]
      ,[b_AgentTF]
      ,[s_AgencyNO]
      ,[s_Agent_NO]
      ,[b_BranchTF]
      ,[s_OriApplicationNO]
      ,[dt_OriApplicationDate]
      ,[b_PctTF]
      ,[n_ClaimItemNum]
      ,[b_ApplicantTransferTF]
      ,[s_ApplicantTransferTo]
      ,[b_IPRTransferTF]
      ,[s_IPRTransferTo]
      ,[s_CurrentOwner]
      ,[s_CityAward]
      ,[s_ProvinceAward]
      ,[s_CountryAward]
      ,[s_Remark]
      ,[b_PlanningDivisionTF]
      ,[b_ElectronicTF]
      ,[n_InvalidTF]
      ,[dt_InvalidDate]
      ,[b_repeatedApp]
      ,[b_repeatedAut]
      ,[n_ValidYear]
      ,[dt_ValidDate]   
  FROM [dbo].[T_PatentCase] WITH(NOLOCK)  
  WHERE n_InvalidTF = 1   
      ]]>
    </commandText>
  </dataCommand>

  <dataCommand name="UpdateElectronicApplicationInfo" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
UPDATE [dbo].[T_PatentCase]
   SET [Application_NO] = @Application_NO
      ,[s_PatentNO] = @s_PatentNO
      ,[s_PatentType] = @s_PatentType
      ,[s_ProfessionCategory] = @s_ProfessionCategory
      ,[s_IndustryCategory] = @s_IndustryCategory
      ,[s_LowStateTotal] = @s_LowStateTotal
      ,[s_LowStateLevel1] = @s_LowStateLevel1
      ,[s_LowStateLevel2] = @s_LowStateLevel2
      ,[s_FailCause] = @s_FailCause
      ,[s_PatentName] = @s_PatentName
      ,[s_ContactorName] = @s_ContactorName
      ,[s_ContactorTel] = @s_ContactorTel
      ,[s_ContactorZip] = @s_ContactorZip
      ,[s_ContactorAddr] = @s_ContactorAddr
      ,[s_ContactorCountry] = @s_ContactorCountry
      ,[s_ContactorProvince] = @s_ContactorProvince
      ,[s_ContactorCity] = @s_ContactorCity
      ,[s_ContactorArea] = @s_ContactorArea
      ,[s_ReducedPayMk] = @s_ReducedPayMk
      ,[b_PriorityTF] = @b_PriorityTF
      ,[b_AgentTF] = @b_AgentTF
      ,[s_AgencyNO] = @s_AgencyNO
      ,[s_Agent_NO] = @s_Agent_NO
      ,[b_BranchTF] = @b_BranchTF
      ,[s_OriApplicationNO] = @s_OriApplicationNO
      ,[dt_OriApplicationDate] = @dt_OriApplicationDate
      ,[b_PctTF] = @b_PctTF
      ,[n_ClaimItemNum] = @n_ClaimItemNum
      ,[b_ApplicantTransferTF] = @b_ApplicantTransferTF
      ,[s_ApplicantTransferTo] = @s_ApplicantTransferTo
      ,[b_IPRTransferTF] = @b_IPRTransferTF
      ,[s_IPRTransferTo] = @s_IPRTransferTo
      ,[s_CurrentOwner] = @s_CurrentOwner
      ,[s_CityAward] = @s_CityAward
      ,[s_ProvinceAward] = @s_ProvinceAward
      ,[s_CountryAward] =@s_CountryAward
      ,[s_Remark] = @s_Remark
      ,[b_PlanningDivisionTF] = @b_PlanningDivisionTF
      ,[b_ElectronicTF] = @b_ElectronicTF
      ,[b_repeatedApp] = @b_repeatedApp
      ,[b_repeatedAut] = @b_repeatedAut
      ,[n_InvalidTF] = @n_InvalidTF
      ,[dt_InvalidDate] = @dt_InvalidDate
      ,[n_ValidYear] = @n_ValidYear 
      ,[dt_ValidDate]=@dt_ValidDate   
         WHERE n_ID=@n_ID
      SELECT SCOPE_IDENTITY();
      ]]>
    </commandText>
    <parameters>
      <param name="@n_ID" dbType="Int64"  direction="Input"/>
      <param name="@Application_NO" dbType="String"  direction="Input"/>
      <param name="@s_PatentNO" dbType="String"  direction="Input"/>
      <param name="@s_PatentType" dbType="String"  direction="Input"/>
      <param name="@s_ProfessionCategory" dbType="String"  direction="Input"/>
      <param name="@s_IndustryCategory" dbType="String"  direction="Input"/>

      <param name="@s_LowStateTotal" dbType="String"  direction="Input"/>
      <param name="@s_LowStateLevel1" dbType="String"  direction="Input"/>
      <param name="@s_LowStateLevel2" dbType="String"  direction="Input"/>
      <param name="@s_FailCause" dbType="String"  direction="Input"/>
      <param name="@s_PatentName" dbType="String"  direction="Input"/>

      <param name="@s_ContactorName" dbType="String"  direction="Input"/>
      <param name="@s_ContactorTel" dbType="String"  direction="Input"/>
      <param name="@s_ContactorZip" dbType="String"  direction="Input"/>
      <param name="@s_ContactorAddr" dbType="String"  direction="Input"/>
      <param name="@s_ContactorCountry" dbType="String"  direction="Input"/>

      <param name="@s_ContactorProvince" dbType="String"  direction="Input"/>
      <param name="@s_ContactorCity" dbType="String"  direction="Input"/>
      <param name="@s_ContactorArea" dbType="String"  direction="Input"/>
      <param name="@s_ReducedPayMk" dbType="String"  direction="Input"/>
      <param name="@b_PriorityTF" dbType="String"  direction="Input"/>

      <param name="@b_AgentTF" dbType="String"  direction="Input"/>
      <param name="@s_AgencyNO" dbType="String"  direction="Input"/>
      <param name="@s_Agent_NO" dbType="String"  direction="Input"/>
      <param name="@b_BranchTF" dbType="String"  direction="Input"/>
      <param name="@s_OriApplicationNO" dbType="String"  direction="Input"/>

      <param name="@dt_OriApplicationDate" dbType="DateTime"  direction="Input"/>
      <param name="@b_PctTF" dbType="String"  direction="Input"/>
      <param name="@n_ClaimItemNum" dbType="Int32"  direction="Input"/>
      <param name="@b_ApplicantTransferTF" dbType="String"  direction="Input"/>
      <param name="@s_ApplicantTransferTo" dbType="String"  direction="Input"/>

      <param name="@b_IPRTransferTF" dbType="String"  direction="Input"/>
      <param name="@s_IPRTransferTo" dbType="String"  direction="Input"/>
      <param name="@s_CurrentOwner" dbType="String"  direction="Input"/>
      <param name="@s_CityAward" dbType="String"  direction="Input"/>
      <param name="@s_ProvinceAward" dbType="String"  direction="Input"/>

      <param name="@s_CountryAward" dbType="String"  direction="Input"/>
      <param name="@s_Remark" dbType="String"  direction="Input"/>
      <param name="@b_PlanningDivisionTF" dbType="String"  direction="Input"/>
      <param name="@b_ElectronicTF" dbType="String"  direction="Input"/>

      <param name="@b_repeatedApp" dbType="String"  direction="Input"/>
      <param name="@b_repeatedAut" dbType="String"  direction="Input"/>

      <param name="@n_InvalidTF" dbType="String"  direction="Input"/>
      <param name="@dt_InvalidDate" dbType="DateTime"  direction="Input"/>
      <param name="@n_ValidYear" dbType="Int32"  direction="Input"/>

      <param name="@dt_ValidDate" dbType="DateTime"  direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="UpdateElectronicApplicationSQ" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
UPDATE [dbo].[T_PatentCase]
   SET [Application_NO] = @Application_NO
      ,[s_PatentNO] = @s_PatentNO
      ,[s_PatentType] = @s_PatentType
      ,[s_ProfessionCategory] = @s_ProfessionCategory
      ,[s_IndustryCategory] = @s_IndustryCategory
      ,[s_LowStateTotal] = @s_LowStateTotal
      ,[s_LowStateLevel1] = @s_LowStateLevel1
      ,[s_LowStateLevel2] = @s_LowStateLevel2
      ,[s_FailCause] = @s_FailCause
      ,[s_PatentName] = @s_PatentName
      ,[s_ContactorName] = @s_ContactorName
      ,[s_ContactorTel] = @s_ContactorTel
      ,[s_ContactorZip] = @s_ContactorZip
      ,[s_ContactorAddr] = @s_ContactorAddr
      ,[s_ContactorCountry] = @s_ContactorCountry
      ,[s_ContactorProvince] = @s_ContactorProvince
      ,[s_ContactorCity] = @s_ContactorCity
      ,[s_ContactorArea] = @s_ContactorArea
      ,[s_ReducedPayMk] = @s_ReducedPayMk
      ,[b_PriorityTF] = @b_PriorityTF
      ,[b_AgentTF] = @b_AgentTF
      ,[s_AgencyNO] = @s_AgencyNO
      ,[s_Agent_NO] = @s_Agent_NO
      ,[b_BranchTF] = @b_BranchTF
      ,[s_OriApplicationNO] = @s_OriApplicationNO
      ,[dt_OriApplicationDate] = @dt_OriApplicationDate
      ,[b_PctTF] = @b_PctTF
      ,[n_ClaimItemNum] = @n_ClaimItemNum
      ,[b_ApplicantTransferTF] = @b_ApplicantTransferTF
      ,[s_ApplicantTransferTo] = @s_ApplicantTransferTo
      ,[b_IPRTransferTF] = @b_IPRTransferTF
      ,[s_IPRTransferTo] = @s_IPRTransferTo
      ,[s_CurrentOwner] = @s_CurrentOwner
      ,[s_CityAward] = @s_CityAward
      ,[s_ProvinceAward] = @s_ProvinceAward
      ,[s_CountryAward] =@s_CountryAward
      ,[s_Remark] = @s_Remark
      ,[b_PlanningDivisionTF] = @b_PlanningDivisionTF
      ,[b_ElectronicTF] = @b_ElectronicTF
      ,[b_repeatedApp] = @b_repeatedApp
      ,[b_repeatedAut] = @b_repeatedAut  
         WHERE n_ID=@n_ID
      SELECT SCOPE_IDENTITY();
      ]]>
    </commandText>
    <parameters>
      <param name="@n_ID" dbType="Int64"  direction="Input"/>
      <param name="@Application_NO" dbType="String"  direction="Input"/>
      <param name="@s_PatentNO" dbType="String"  direction="Input"/>
      <param name="@s_PatentType" dbType="String"  direction="Input"/>
      <param name="@s_ProfessionCategory" dbType="String"  direction="Input"/>
      <param name="@s_IndustryCategory" dbType="String"  direction="Input"/>

      <param name="@s_LowStateTotal" dbType="String"  direction="Input"/>
      <param name="@s_LowStateLevel1" dbType="String"  direction="Input"/>
      <param name="@s_LowStateLevel2" dbType="String"  direction="Input"/>
      <param name="@s_FailCause" dbType="String"  direction="Input"/>
      <param name="@s_PatentName" dbType="String"  direction="Input"/>

      <param name="@s_ContactorName" dbType="String"  direction="Input"/>
      <param name="@s_ContactorTel" dbType="String"  direction="Input"/>
      <param name="@s_ContactorZip" dbType="String"  direction="Input"/>
      <param name="@s_ContactorAddr" dbType="String"  direction="Input"/>
      <param name="@s_ContactorCountry" dbType="String"  direction="Input"/>

      <param name="@s_ContactorProvince" dbType="String"  direction="Input"/>
      <param name="@s_ContactorCity" dbType="String"  direction="Input"/>
      <param name="@s_ContactorArea" dbType="String"  direction="Input"/>
      <param name="@s_ReducedPayMk" dbType="String"  direction="Input"/>
      <param name="@b_PriorityTF" dbType="String"  direction="Input"/>

      <param name="@b_AgentTF" dbType="String"  direction="Input"/>
      <param name="@s_AgencyNO" dbType="String"  direction="Input"/>
      <param name="@s_Agent_NO" dbType="String"  direction="Input"/>
      <param name="@b_BranchTF" dbType="String"  direction="Input"/>
      <param name="@s_OriApplicationNO" dbType="String"  direction="Input"/>

      <param name="@dt_OriApplicationDate" dbType="DateTime"  direction="Input"/>
      <param name="@b_PctTF" dbType="String"  direction="Input"/>
      <param name="@n_ClaimItemNum" dbType="Int32"  direction="Input"/>
      <param name="@b_ApplicantTransferTF" dbType="String"  direction="Input"/>
      <param name="@s_ApplicantTransferTo" dbType="String"  direction="Input"/>

      <param name="@b_IPRTransferTF" dbType="String"  direction="Input"/>
      <param name="@s_IPRTransferTo" dbType="String"  direction="Input"/>
      <param name="@s_CurrentOwner" dbType="String"  direction="Input"/>
      <param name="@s_CityAward" dbType="String"  direction="Input"/>
      <param name="@s_ProvinceAward" dbType="String"  direction="Input"/>

      <param name="@s_CountryAward" dbType="String"  direction="Input"/>
      <param name="@s_Remark" dbType="String"  direction="Input"/>
      <param name="@b_PlanningDivisionTF" dbType="String"  direction="Input"/>
      <param name="@b_ElectronicTF" dbType="String"  direction="Input"/>

      <param name="@b_repeatedApp" dbType="String"  direction="Input"/>
      <param name="@b_repeatedAut" dbType="String"  direction="Input"/>

    </parameters>
  </dataCommand>
  <dataCommand name="UpdateElectronicApplicationSQ2" database="MDATA2" commandType="Text">
    <commandText>
      <![CDATA[ 
UPDATE [dbo].[T_PatentCase]
   SET [Application_NO] = @Application_NO
      ,[s_PatentNO] = @s_PatentNO
      ,[s_PatentType] = @s_PatentType
      ,[s_ProfessionCategory] = @s_ProfessionCategory
      ,[s_IndustryCategory] = @s_IndustryCategory
      ,[s_LowStateTotal] = @s_LowStateTotal
      ,[s_LowStateLevel1] = @s_LowStateLevel1
      ,[s_LowStateLevel2] = @s_LowStateLevel2
      ,[s_FailCause] = @s_FailCause
      ,[s_PatentName] = @s_PatentName
      ,[s_ContactorName] = @s_ContactorName
      ,[s_ContactorTel] = @s_ContactorTel
      ,[s_ContactorZip] = @s_ContactorZip
      ,[s_ContactorAddr] = @s_ContactorAddr
      ,[s_ContactorCountry] = @s_ContactorCountry
      ,[s_ContactorProvince] = @s_ContactorProvince
      ,[s_ContactorCity] = @s_ContactorCity
      ,[s_ContactorArea] = @s_ContactorArea
      ,[s_ReducedPayMk] = @s_ReducedPayMk
      ,[b_PriorityTF] = @b_PriorityTF
      ,[b_AgentTF] = @b_AgentTF
      ,[s_AgencyNO] = @s_AgencyNO
      ,[s_Agent_NO] = @s_Agent_NO
      ,[b_BranchTF] = @b_BranchTF
      ,[s_OriApplicationNO] = @s_OriApplicationNO
      ,[dt_OriApplicationDate] = @dt_OriApplicationDate
      ,[b_PctTF] = @b_PctTF
      ,[n_ClaimItemNum] = @n_ClaimItemNum
      ,[b_ApplicantTransferTF] = @b_ApplicantTransferTF
      ,[s_ApplicantTransferTo] = @s_ApplicantTransferTo
      ,[b_IPRTransferTF] = @b_IPRTransferTF
      ,[s_IPRTransferTo] = @s_IPRTransferTo
      ,[s_CurrentOwner] = @s_CurrentOwner
      ,[s_CityAward] = @s_CityAward
      ,[s_ProvinceAward] = @s_ProvinceAward
      ,[s_CountryAward] =@s_CountryAward
      ,[s_Remark] = @s_Remark
      ,[b_PlanningDivisionTF] = @b_PlanningDivisionTF
      ,[b_ElectronicTF] = @b_ElectronicTF
      ,[b_repeatedApp] = @b_repeatedApp
      ,[b_repeatedAut] = @b_repeatedAut  
         WHERE n_ID=@n_ID
      SELECT SCOPE_IDENTITY();
      ]]>
    </commandText>
    <parameters>
      <param name="@n_ID" dbType="Int64"  direction="Input"/>
      <param name="@Application_NO" dbType="String"  direction="Input"/>
      <param name="@s_PatentNO" dbType="String"  direction="Input"/>
      <param name="@s_PatentType" dbType="String"  direction="Input"/>
      <param name="@s_ProfessionCategory" dbType="String"  direction="Input"/>
      <param name="@s_IndustryCategory" dbType="String"  direction="Input"/>

      <param name="@s_LowStateTotal" dbType="String"  direction="Input"/>
      <param name="@s_LowStateLevel1" dbType="String"  direction="Input"/>
      <param name="@s_LowStateLevel2" dbType="String"  direction="Input"/>
      <param name="@s_FailCause" dbType="String"  direction="Input"/>
      <param name="@s_PatentName" dbType="String"  direction="Input"/>

      <param name="@s_ContactorName" dbType="String"  direction="Input"/>
      <param name="@s_ContactorTel" dbType="String"  direction="Input"/>
      <param name="@s_ContactorZip" dbType="String"  direction="Input"/>
      <param name="@s_ContactorAddr" dbType="String"  direction="Input"/>
      <param name="@s_ContactorCountry" dbType="String"  direction="Input"/>

      <param name="@s_ContactorProvince" dbType="String"  direction="Input"/>
      <param name="@s_ContactorCity" dbType="String"  direction="Input"/>
      <param name="@s_ContactorArea" dbType="String"  direction="Input"/>
      <param name="@s_ReducedPayMk" dbType="String"  direction="Input"/>
      <param name="@b_PriorityTF" dbType="String"  direction="Input"/>

      <param name="@b_AgentTF" dbType="String"  direction="Input"/>
      <param name="@s_AgencyNO" dbType="String"  direction="Input"/>
      <param name="@s_Agent_NO" dbType="String"  direction="Input"/>
      <param name="@b_BranchTF" dbType="String"  direction="Input"/>
      <param name="@s_OriApplicationNO" dbType="String"  direction="Input"/>

      <param name="@dt_OriApplicationDate" dbType="DateTime"  direction="Input"/>
      <param name="@b_PctTF" dbType="String"  direction="Input"/>
      <param name="@n_ClaimItemNum" dbType="Int32"  direction="Input"/>
      <param name="@b_ApplicantTransferTF" dbType="String"  direction="Input"/>
      <param name="@s_ApplicantTransferTo" dbType="String"  direction="Input"/>

      <param name="@b_IPRTransferTF" dbType="String"  direction="Input"/>
      <param name="@s_IPRTransferTo" dbType="String"  direction="Input"/>
      <param name="@s_CurrentOwner" dbType="String"  direction="Input"/>
      <param name="@s_CityAward" dbType="String"  direction="Input"/>
      <param name="@s_ProvinceAward" dbType="String"  direction="Input"/>

      <param name="@s_CountryAward" dbType="String"  direction="Input"/>
      <param name="@s_Remark" dbType="String"  direction="Input"/>
      <param name="@b_PlanningDivisionTF" dbType="String"  direction="Input"/>
      <param name="@b_ElectronicTF" dbType="String"  direction="Input"/>

      <param name="@b_repeatedApp" dbType="String"  direction="Input"/>
      <param name="@b_repeatedAut" dbType="String"  direction="Input"/>

    </parameters>
  </dataCommand>
  <dataCommand name="UpdateElectronicApplicationInfo2" database="MDATA2" commandType="Text">
    <commandText>
      <![CDATA[ 
UPDATE [dbo].[T_PatentCase]
   SET [Application_NO] = @Application_NO
      ,[s_PatentNO] = @s_PatentNO
      ,[s_PatentType] = @s_PatentType
      ,[s_ProfessionCategory] = @s_ProfessionCategory
      ,[s_IndustryCategory] = @s_IndustryCategory
      ,[s_LowStateTotal] = @s_LowStateTotal
      ,[s_LowStateLevel1] = @s_LowStateLevel1
      ,[s_LowStateLevel2] = @s_LowStateLevel2
      ,[s_FailCause] = @s_FailCause
      ,[s_PatentName] = @s_PatentName
      ,[s_ContactorName] = @s_ContactorName
      ,[s_ContactorTel] = @s_ContactorTel
      ,[s_ContactorZip] = @s_ContactorZip
      ,[s_ContactorAddr] = @s_ContactorAddr
      ,[s_ContactorCountry] = @s_ContactorCountry
      ,[s_ContactorProvince] = @s_ContactorProvince
      ,[s_ContactorCity] = @s_ContactorCity
      ,[s_ContactorArea] = @s_ContactorArea
      ,[s_ReducedPayMk] = @s_ReducedPayMk
      ,[b_PriorityTF] = @b_PriorityTF
      ,[b_AgentTF] = @b_AgentTF
      ,[s_AgencyNO] = @s_AgencyNO
      ,[s_Agent_NO] = @s_Agent_NO
      ,[b_BranchTF] = @b_BranchTF
      ,[s_OriApplicationNO] = @s_OriApplicationNO
      ,[dt_OriApplicationDate] = @dt_OriApplicationDate
      ,[b_PctTF] = @b_PctTF
      ,[n_ClaimItemNum] = @n_ClaimItemNum
      ,[b_ApplicantTransferTF] = @b_ApplicantTransferTF
      ,[s_ApplicantTransferTo] = @s_ApplicantTransferTo
      ,[b_IPRTransferTF] = @b_IPRTransferTF
      ,[s_IPRTransferTo] = @s_IPRTransferTo
      ,[s_CurrentOwner] = @s_CurrentOwner
      ,[s_CityAward] = @s_CityAward
      ,[s_ProvinceAward] = @s_ProvinceAward
      ,[s_CountryAward] =@s_CountryAward
      ,[s_Remark] = @s_Remark
      ,[b_PlanningDivisionTF] = @b_PlanningDivisionTF
      ,[b_ElectronicTF] = @b_ElectronicTF
      ,[b_repeatedApp] = @b_repeatedApp
      ,[b_repeatedAut] = @b_repeatedAut
      ,[n_InvalidTF] = @n_InvalidTF
      ,[dt_InvalidDate] = @dt_InvalidDate
      ,[n_ValidYear] = @n_ValidYear
      ,[dt_ValidDate] = @dt_ValidDate   
         WHERE n_ID=@n_ID
      SELECT SCOPE_IDENTITY();
      ]]>
    </commandText>
    <parameters>
      <param name="@n_ID" dbType="Int64"  direction="Input"/>
      <param name="@Application_NO" dbType="String"  direction="Input"/>
      <param name="@s_PatentNO" dbType="String"  direction="Input"/>
      <param name="@s_PatentType" dbType="String"  direction="Input"/>
      <param name="@s_ProfessionCategory" dbType="String"  direction="Input"/>
      <param name="@s_IndustryCategory" dbType="String"  direction="Input"/>

      <param name="@s_LowStateTotal" dbType="String"  direction="Input"/>
      <param name="@s_LowStateLevel1" dbType="String"  direction="Input"/>
      <param name="@s_LowStateLevel2" dbType="String"  direction="Input"/>
      <param name="@s_FailCause" dbType="String"  direction="Input"/>
      <param name="@s_PatentName" dbType="String"  direction="Input"/>

      <param name="@s_ContactorName" dbType="String"  direction="Input"/>
      <param name="@s_ContactorTel" dbType="String"  direction="Input"/>
      <param name="@s_ContactorZip" dbType="String"  direction="Input"/>
      <param name="@s_ContactorAddr" dbType="String"  direction="Input"/>
      <param name="@s_ContactorCountry" dbType="String"  direction="Input"/>

      <param name="@s_ContactorProvince" dbType="String"  direction="Input"/>
      <param name="@s_ContactorCity" dbType="String"  direction="Input"/>
      <param name="@s_ContactorArea" dbType="String"  direction="Input"/>
      <param name="@s_ReducedPayMk" dbType="String"  direction="Input"/>
      <param name="@b_PriorityTF" dbType="String"  direction="Input"/>

      <param name="@b_AgentTF" dbType="String"  direction="Input"/>
      <param name="@s_AgencyNO" dbType="String"  direction="Input"/>
      <param name="@s_Agent_NO" dbType="String"  direction="Input"/>
      <param name="@b_BranchTF" dbType="String"  direction="Input"/>
      <param name="@s_OriApplicationNO" dbType="String"  direction="Input"/>

      <param name="@dt_OriApplicationDate" dbType="DateTime"  direction="Input"/>
      <param name="@b_PctTF" dbType="String"  direction="Input"/>
      <param name="@n_ClaimItemNum" dbType="Int32"  direction="Input"/>
      <param name="@b_ApplicantTransferTF" dbType="String"  direction="Input"/>
      <param name="@s_ApplicantTransferTo" dbType="String"  direction="Input"/>

      <param name="@b_IPRTransferTF" dbType="String"  direction="Input"/>
      <param name="@s_IPRTransferTo" dbType="String"  direction="Input"/>
      <param name="@s_CurrentOwner" dbType="String"  direction="Input"/>
      <param name="@s_CityAward" dbType="String"  direction="Input"/>
      <param name="@s_ProvinceAward" dbType="String"  direction="Input"/>

      <param name="@s_CountryAward" dbType="String"  direction="Input"/>
      <param name="@s_Remark" dbType="String"  direction="Input"/>
      <param name="@b_PlanningDivisionTF" dbType="String"  direction="Input"/>
      <param name="@b_ElectronicTF" dbType="String"  direction="Input"/>

      <param name="@b_repeatedApp" dbType="String"  direction="Input"/>
      <param name="@b_repeatedAut" dbType="String"  direction="Input"/>

      <param name="@n_InvalidTF" dbType="String"  direction="Input"/>
      <param name="@dt_InvalidDate" dbType="DateTime"  direction="Input"/>
      <param name="@n_ValidYear" dbType="Int32"  direction="Input"/>

      <param name="@dt_ValidDate" dbType="DateTime"  direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="GetGDPAPatentListBaseData" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
SELECT [n_ID]
      ,[s_Name]
      ,[f_FMCount]
      ,[f_SYXXCount]
      ,[f_WGSJCount]
      ,[f_TotalCount]
      ,[s_year]
      ,[s_Type]
  FROM [dbo].[T_PatentListBaseData] WITH(NOLOCK)
  WHERE s_Type=@s_Type
      ]]>
    </commandText>
    <parameters>
      <param name="@s_Type" dbType="AnsiStringFixedLength" direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="UpdateGDPAPatentListBaseData1" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
UPDATE [GDPA_One].[dbo].[T_PatentListBaseData]
     SET [f_FMCount] = (select  count(1)from [GDPA_One].[dbo].[T_PatentCase] where [s_AgencyNO] like '44%' and [s_PatentType]='1')
      ,[f_SYXXCount] = (select  count(1)from [GDPA_One].[dbo].[T_PatentCase] where [s_AgencyNO] like '44%' and [s_PatentType]='2')
      ,[f_WGSJCount] = (select  count(1)from [GDPA_One].[dbo].[T_PatentCase] where [s_AgencyNO] like '44%' and [s_PatentType]='3')
      ,[f_TotalCount] = (select count(1) as c from T_PatentCase where s_AgencyNO like '44%')
         WHERE n_ID=1
      SELECT SCOPE_IDENTITY();
      ]]>
    </commandText>
  </dataCommand>
  <dataCommand name="UpdateGDPAPatentListBaseData2" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
UPDATE [dbo].[T_PatentListBaseData]
     SET [f_FMCount] = (select  count(1)from [GDPA_One].[dbo].[T_PatentCase] where [s_AgencyNO] !=0 and [s_PatentType]='1')
      ,[f_SYXXCount] = (select  count(1)from [GDPA_One].[dbo].[T_PatentCase] where [s_AgencyNO] !=0 and [s_PatentType]='2')
      ,[f_WGSJCount] = (select  count(1)from [GDPA_One].[dbo].[T_PatentCase] where [s_AgencyNO] !=0 and [s_PatentType]='3')
      ,[f_TotalCount] = (select  count(1)from [GDPA_One].[dbo].[T_PatentCase] where [s_AgencyNO] !=0)
         WHERE n_ID=2
      SELECT SCOPE_IDENTITY();
      ]]>
    </commandText>
  </dataCommand>
  <!--申请，授权，有效数据表 T_Applicants-->
  <dataCommand name="InsertApplicantsInfo" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
INSERT INTO [dbo].[T_Applicants]
           ([s_ApplicationNO]
           ,[n_Sequence]
           ,[s_ApplicantSort]
           ,[s_Name]
           ,[b_RepresentTF]
           ,[s_ApplicantType]
           ,[s_EnterpriseNature]
           ,[s_EnterpriseSize]
           ,[s_IPRNature]
           ,[s_ApplicantAward]
           ,[s_ApplicantCode]
           ,[s_Country]
           ,[s_Province]
           ,[s_City]
           ,[s_Area]
           ,[s_Addr]
           ,[s_Zip]
           ,[s_TEL]
           ,[s_Remark])
     VALUES
          (@s_ApplicationNO 
           ,@n_Sequence 
           ,@s_ApplicantSort 
           ,@s_Name 
           ,@b_RepresentTF 
           ,@s_ApplicantType 
           ,@s_EnterpriseNature 
           ,@s_EnterpriseSize
           ,@s_IPRNature
           ,@s_ApplicantAward 
           ,@s_ApplicantCode
           ,@s_Country 
           ,@s_Province
           ,@s_City 
           ,@s_Area 
           ,@s_Addr 
           ,@s_Zip 
           ,@s_TEL 
           ,@s_Remark)
          SELECT SCOPE_IDENTITY();
      ]]>
    </commandText>
    <parameters>
      <param name="@s_ApplicationNO" dbType="String"  direction="Input"/>
      <param name="@n_Sequence" dbType="Int32"  direction="Input"/>
      <param name="@s_ApplicantSort" dbType="String"  direction="Input"/>
      <param name="@s_Name" dbType="String"  direction="Input"/>
      <param name="@b_RepresentTF" dbType="String"  direction="Input"/>

      <param name="@s_ApplicantType" dbType="String"  direction="Input"/>
      <param name="@s_EnterpriseNature" dbType="String"  direction="Input"/>
      <param name="@s_EnterpriseSize" dbType="String"  direction="Input"/>
      <param name="@s_IPRNature" dbType="String"  direction="Input"/>
      <param name="@s_ApplicantAward" dbType="String"  direction="Input"/>
      <param name="@s_ApplicantCode" dbType="String"  direction="Input"/>
      <param name="@s_Country" dbType="String"  direction="Input"/>
      <param name="@s_Province" dbType="String"  direction="Input"/>
      <param name="@s_City" dbType="String"  direction="Input"/>
      <param name="@s_Area" dbType="String"  direction="Input"/>
      <param name="@s_Addr" dbType="String"  direction="Input"/>
      <param name="@s_Zip" dbType="String"  direction="Input"/>

      <param name="@s_TEL" dbType="String"  direction="Input"/>
      <param name="@s_Remark" dbType="String"  direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="InsertApplicantsInfo2" database="MDATA2" commandType="Text">
    <commandText>
      <![CDATA[ 
INSERT INTO [dbo].[T_Applicants]
           ([s_ApplicationNO]
           ,[n_Sequence]
           ,[s_ApplicantSort]
           ,[s_Name]
           ,[b_RepresentTF]
           ,[s_ApplicantType]
           ,[s_EnterpriseNature]
           ,[s_EnterpriseSize]
           ,[s_IPRNature]
           ,[s_ApplicantAward]
           ,[s_ApplicantCode]
           ,[s_Country]
           ,[s_Province]
           ,[s_City]
           ,[s_Area]
           ,[s_Addr]
           ,[s_Zip]
           ,[s_TEL]
           ,[s_Remark])
     VALUES
          (@s_ApplicationNO 
           ,@n_Sequence 
           ,@s_ApplicantSort 
           ,@s_Name 
           ,@b_RepresentTF 
           ,@s_ApplicantType 
           ,@s_EnterpriseNature 
           ,@s_EnterpriseSize
           ,@s_IPRNature
           ,@s_ApplicantAward 
           ,@s_ApplicantCode
           ,@s_Country 
           ,@s_Province
           ,@s_City 
           ,@s_Area 
           ,@s_Addr 
           ,@s_Zip 
           ,@s_TEL 
           ,@s_Remark)
          SELECT SCOPE_IDENTITY();
      ]]>
    </commandText>
    <parameters>
      <param name="@s_ApplicationNO" dbType="String"  direction="Input"/>
      <param name="@n_Sequence" dbType="Int32"  direction="Input"/>
      <param name="@s_ApplicantSort" dbType="String"  direction="Input"/>
      <param name="@s_Name" dbType="String"  direction="Input"/>
      <param name="@b_RepresentTF" dbType="String"  direction="Input"/>

      <param name="@s_ApplicantType" dbType="String"  direction="Input"/>
      <param name="@s_EnterpriseNature" dbType="String"  direction="Input"/>
      <param name="@s_EnterpriseSize" dbType="String"  direction="Input"/>
      <param name="@s_IPRNature" dbType="String"  direction="Input"/>
      <param name="@s_ApplicantAward" dbType="String"  direction="Input"/>
      <param name="@s_ApplicantCode" dbType="String"  direction="Input"/>
      <param name="@s_Country" dbType="String"  direction="Input"/>
      <param name="@s_Province" dbType="String"  direction="Input"/>
      <param name="@s_City" dbType="String"  direction="Input"/>
      <param name="@s_Area" dbType="String"  direction="Input"/>
      <param name="@s_Addr" dbType="String"  direction="Input"/>
      <param name="@s_Zip" dbType="String"  direction="Input"/>

      <param name="@s_TEL" dbType="String"  direction="Input"/>
      <param name="@s_Remark" dbType="String"  direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="UpdateApplicantsInfo" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
UPDATE [dbo].[T_Applicants]
   SET [s_ApplicationNO] = @s_ApplicationNO
      ,[n_Sequence] = @n_Sequence
      ,[s_ApplicantSort] = @s_ApplicantSort
      ,[s_Name] = @s_Name
      ,[b_RepresentTF] = @b_RepresentTF
      ,[s_ApplicantType] = @s_ApplicantType
      ,[s_EnterpriseNature] = @s_EnterpriseNature
      ,[s_EnterpriseSize] = @s_EnterpriseSize
      ,[s_IPRNature] = @s_IPRNature
      ,[s_ApplicantAward] = @s_ApplicantAward
      ,[s_ApplicantCode] = @s_ApplicantCode
      ,[s_Country] = @s_Country
      ,[s_Province] = @s_Province
      ,[s_City] = @s_City
      ,[s_Area] = @s_Area
      ,[s_Addr] = @s_Addr
      ,[s_Zip] = @s_Zip
      ,[s_TEL] = @s_TEL
      ,[s_Remark] = @s_Remark
       WHERE n_ID=@n_ID
          SELECT SCOPE_IDENTITY();
      ]]>
    </commandText>
    <parameters>
      <param name="@n_ID" dbType="Int32"  direction="Input"/>
      <param name="@s_ApplicationNO" dbType="String"  direction="Input"/>
      <param name="@n_Sequence" dbType="Int32"  direction="Input"/>
      <param name="@s_ApplicantSort" dbType="String"  direction="Input"/>
      <param name="@s_Name" dbType="String"  direction="Input"/>
      <param name="@b_RepresentTF" dbType="String"  direction="Input"/>

      <param name="@s_ApplicantType" dbType="String"  direction="Input"/>
      <param name="@s_EnterpriseNature" dbType="String"  direction="Input"/>
      <param name="@s_EnterpriseSize" dbType="String"  direction="Input"/>
      <param name="@s_IPRNature" dbType="String"  direction="Input"/>
      <param name="@s_ApplicantAward" dbType="String"  direction="Input"/>
      <param name="@s_ApplicantCode" dbType="String"  direction="Input"/>
      <param name="@s_Country" dbType="String"  direction="Input"/>
      <param name="@s_Province" dbType="String"  direction="Input"/>
      <param name="@s_City" dbType="String"  direction="Input"/>
      <param name="@s_Area" dbType="String"  direction="Input"/>
      <param name="@s_Addr" dbType="String"  direction="Input"/>
      <param name="@s_Zip" dbType="String"  direction="Input"/>

      <param name="@s_TEL" dbType="String"  direction="Input"/>
      <param name="@s_Remark" dbType="String"  direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="UpdateApplicantsInfo2" database="MDATA2" commandType="Text">
    <commandText>
      <![CDATA[ 
UPDATE [dbo].[T_Applicants]
   SET [s_ApplicationNO] = @s_ApplicationNO
      ,[n_Sequence] = @n_Sequence
      ,[s_ApplicantSort] = @s_ApplicantSort
      ,[s_Name] = @s_Name
      ,[b_RepresentTF] = @b_RepresentTF
      ,[s_ApplicantType] = @s_ApplicantType
      ,[s_EnterpriseNature] = @s_EnterpriseNature
      ,[s_EnterpriseSize] = @s_EnterpriseSize
      ,[s_IPRNature] = @s_IPRNature
      ,[s_ApplicantAward] = @s_ApplicantAward
      ,[s_ApplicantCode] = @s_ApplicantCode
      ,[s_Country] = @s_Country
      ,[s_Province] = @s_Province
      ,[s_City] = @s_City
      ,[s_Area] = @s_Area
      ,[s_Addr] = @s_Addr
      ,[s_Zip] = @s_Zip
      ,[s_TEL] = @s_TEL
      ,[s_Remark] = @s_Remark
       WHERE n_ID=@n_ID
          SELECT SCOPE_IDENTITY();
      ]]>
    </commandText>
    <parameters>
      <param name="@n_ID" dbType="Int32"  direction="Input"/>
      <param name="@s_ApplicationNO" dbType="String"  direction="Input"/>
      <param name="@n_Sequence" dbType="Int32"  direction="Input"/>
      <param name="@s_ApplicantSort" dbType="String"  direction="Input"/>
      <param name="@s_Name" dbType="String"  direction="Input"/>
      <param name="@b_RepresentTF" dbType="String"  direction="Input"/>

      <param name="@s_ApplicantType" dbType="String"  direction="Input"/>
      <param name="@s_EnterpriseNature" dbType="String"  direction="Input"/>
      <param name="@s_EnterpriseSize" dbType="String"  direction="Input"/>
      <param name="@s_IPRNature" dbType="String"  direction="Input"/>
      <param name="@s_ApplicantAward" dbType="String"  direction="Input"/>
      <param name="@s_ApplicantCode" dbType="String"  direction="Input"/>
      <param name="@s_Country" dbType="String"  direction="Input"/>
      <param name="@s_Province" dbType="String"  direction="Input"/>
      <param name="@s_City" dbType="String"  direction="Input"/>
      <param name="@s_Area" dbType="String"  direction="Input"/>
      <param name="@s_Addr" dbType="String"  direction="Input"/>
      <param name="@s_Zip" dbType="String"  direction="Input"/>

      <param name="@s_TEL" dbType="String"  direction="Input"/>
      <param name="@s_Remark" dbType="String"  direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="GetGDPAApplicantsByAppNO" database="MDATA2" commandType="Text">
    <commandText>
      <![CDATA[ 
SELECT [n_ID]
      ,[s_ApplicationNO]
      ,[n_Sequence]
      ,[s_ApplicantSort]
      ,[s_Name]
      ,[b_RepresentTF]
      ,[s_ApplicantType]
      ,[s_EnterpriseNature]
      ,[s_EnterpriseSize]
      ,[s_IPRNature]
      ,[s_ApplicantAward]
      ,[s_ApplicantCode]
      ,[s_Country]
      ,[s_Province]
      ,[s_City]
      ,[s_Area]
      ,[s_Addr]
      ,[s_Zip]
      ,[s_TEL]
      ,[s_Remark]   
  FROM [dbo].[T_Applicants] WITH(NOLOCK)
      WHERE s_ApplicationNO=@ApplicationNo
      AND n_Sequence=@Squence
      AND s_ApplicantSort=@ApplicantSort   
      ]]>
    </commandText>
    <parameters>
      <param name="@ApplicationNo" dbType="AnsiStringFixedLength" direction="Input"/>
      <param name="@Squence" dbType="AnsiStringFixedLength" direction="Input"/>
      <param name="@ApplicantSort" dbType="AnsiStringFixedLength" direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="GetGDPAApplicantsByAppNO1" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
SELECT [n_ID]
      ,[s_ApplicationNO]
      ,[n_Sequence]
      ,[s_ApplicantSort]
      ,[s_Name]
      ,[b_RepresentTF]
      ,[s_ApplicantType]
      ,[s_EnterpriseNature]
      ,[s_EnterpriseSize]
      ,[s_IPRNature]
      ,[s_ApplicantAward]
      ,[s_ApplicantCode]
      ,[s_Country]
      ,[s_Province]
      ,[s_City]
      ,[s_Area]
      ,[s_Addr]
      ,[s_Zip]
      ,[s_TEL]
      ,[s_Remark]
  FROM [dbo].[T_Applicants] WITH(NOLOCK)
      WHERE s_ApplicationNO=@ApplicationNo
      AND n_Sequence=@Squence
      AND s_ApplicantSort=@ApplicantSort   
      ]]>
    </commandText>
    <parameters>
      <param name="@ApplicationNo" dbType="AnsiStringFixedLength" direction="Input"/>
      <param name="@Squence" dbType="AnsiStringFixedLength" direction="Input"/>
      <param name="@ApplicantSort" dbType="AnsiStringFixedLength" direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="GetGDPAApplicantsByAppNO2" database="MDATA2" commandType="Text">
    <commandText>
      <![CDATA[ 
SELECT [n_ID]
      ,[s_ApplicationNO]
      ,[n_Sequence]
      ,[s_ApplicantSort]
      ,[s_Name]
      ,[b_RepresentTF]
      ,[s_ApplicantType]
      ,[s_EnterpriseNature]
      ,[s_EnterpriseSize]
      ,[s_IPRNature]
      ,[s_ApplicantAward]
      ,[s_ApplicantCode]
      ,[s_Country]
      ,[s_Province]
      ,[s_City]
      ,[s_Area]
      ,[s_Addr]
      ,[s_Zip]
      ,[s_TEL]
      ,[s_Remark]
  FROM [dbo].[T_Applicants] WITH(NOLOCK)
      WHERE s_ApplicationNO=@ApplicationNo 
      AND n_Sequence=@Squence   
      ]]>
    </commandText>
    <parameters>
      <param name="@ApplicationNo" dbType="AnsiStringFixedLength" direction="Input"/>
      <param name="@Squence" dbType="Int32" direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="GetGDPAApplicantsByParams" database="MDATA2" commandType="Text">
    <commandText>
      <![CDATA[ 
SELECT [n_ID]
      ,[s_ApplicationNO]
      ,[n_Sequence]
      ,[s_ApplicantSort]
      ,[s_Name]
      ,[b_RepresentTF]
      ,[s_ApplicantType]
      ,[s_EnterpriseNature]
      ,[s_EnterpriseSize]
      ,[s_IPRNature]
      ,[s_ApplicantAward]
      ,[s_ApplicantCode]
      ,[s_Country]
      ,[s_Province]
      ,[s_City]
      ,[s_Area]
      ,[s_Addr]
      ,[s_Zip]
      ,[s_TEL]
      ,[s_Remark]
  FROM [dbo].[T_Applicants] WITH(NOLOCK) 
      WHERE s_ApplicationNO=@ApplicationNo 
      AND n_Sequence=@Sequence   
      ]]>
    </commandText>
    <parameters>
      <param name="@ApplicationNo" dbType="AnsiStringFixedLength" direction="Input"/>
      <param name="@Sequence" dbType="AnsiStringFixedLength" direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="GetGDPAApplicantsByParams1" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
SELECT [n_ID]
      ,[s_ApplicationNO]
      ,[n_Sequence]
      ,[s_ApplicantSort]
      ,[s_Name]
      ,[b_RepresentTF]
      ,[s_ApplicantType]
      ,[s_EnterpriseNature]
      ,[s_EnterpriseSize]
      ,[s_IPRNature]
      ,[s_ApplicantAward]
      ,[s_ApplicantCode]
      ,[s_Country]
      ,[s_Province]
      ,[s_City]
      ,[s_Area]
      ,[s_Addr]
      ,[s_Zip]
      ,[s_TEL]
      ,[s_Remark]
  FROM [dbo].[T_Applicants] WITH(NOLOCK) 
      WHERE s_ApplicationNO=@ApplicationNo 
      AND n_Sequence=@Sequence   
      ]]>
    </commandText>
    <parameters>
      <param name="@ApplicationNo" dbType="AnsiStringFixedLength" direction="Input"/>
      <param name="@Sequence" dbType="AnsiStringFixedLength" direction="Input"/>
    </parameters>
  </dataCommand>

  <!--申请，授权，有效数据表 T_PatentStatus-->
  <dataCommand name="InsertPatentStatusInfo" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
INSERT INTO [dbo].[T_PatentStatus]
           ([s_ApplicationNO]
           ,[dt_ApplyDate]
           ,[dt_PrimaryDate]
           ,[dt_OpenDate]
           ,[dt_ActualDate]
           ,[dt_RejectDate]
           ,[dt_RetractDate]
           ,[dt_ASRetractDate]
           ,[dt_AsAbandonDate]
           ,[dt_AuthorizeDate]
           ,[dt_ReViewDate]
           ,[dt_InvalidDate]
           ,[dt_EndDate]
           ,[dt_RecoveryDate]
           ,[dt_AppRightTranDate]
           ,[dt_PatentRightTranDate]
           ,[dt_InheritDate]
           ,[dt_EnforceDate]
           ,[s_Remark]
           ,[dt_OriApplicaDate]
           ,[dt_OriAuthorizeDate]
           ,[dt_ApplyStorageDate]
           ,[dt_AuthorizeStorageDate])
     VALUES
          (@s_ApplicationNO 
           ,@dt_ApplyDate 
           ,@dt_PrimaryDate 
           ,@dt_OpenDate 
           ,@dt_ActualDate 
           ,@dt_RejectDate 
           ,@dt_RetractDate 
           ,@dt_ASRetractDate
           ,@dt_AsAbandonDate
           ,@dt_AuthorizeDate 
           ,@dt_ReViewDate
           ,@dt_InvalidDate 
           ,@dt_EndDate
           ,@dt_RecoveryDate 
           ,@dt_AppRightTranDate 
           ,@dt_PatentRightTranDate 
           ,@dt_InheritDate 
           ,@dt_EnforceDate 
           ,@s_Remark
           ,@dt_OriApplicaDate
           ,@dt_OriAuthorizeDate
           ,@dt_ApplyStorageDate
           ,@dt_AuthorizeStorageDate)
          SELECT SCOPE_IDENTITY();
      ]]>
    </commandText>
    <parameters>
      <param name="@s_ApplicationNO" dbType="String"  direction="Input"/>
      <param name="@dt_ApplyDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_PrimaryDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_OpenDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_ActualDate" dbType="DateTime"  direction="Input"/>

      <param name="@dt_RejectDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_RetractDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_ASRetractDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_AsAbandonDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_AuthorizeDate" dbType="DateTime"  direction="Input"/>

      <param name="@dt_ReViewDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_InvalidDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_EndDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_RecoveryDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_AppRightTranDate" dbType="DateTime"  direction="Input"/>

      <param name="@dt_PatentRightTranDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_InheritDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_EnforceDate" dbType="DateTime"  direction="Input"/>
      <param name="@s_Remark" dbType="String"  direction="Input"/>
      <param name="@dt_OriApplicaDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_OriAuthorizeDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_ApplyStorageDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_AuthorizeStorageDate" dbType="DateTime"  direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="InsertPatentStatusInfo2" database="MDATA2" commandType="Text">
    <commandText>
      <![CDATA[ 
INSERT INTO [dbo].[T_PatentStatus]
           ([s_ApplicationNO]
           ,[dt_ApplyDate]
           ,[dt_PrimaryDate]
           ,[dt_OpenDate]
           ,[dt_ActualDate]
           ,[dt_RejectDate]
           ,[dt_RetractDate]
           ,[dt_ASRetractDate]
           ,[dt_AsAbandonDate]
           ,[dt_AuthorizeDate]
           ,[dt_ReViewDate]
           ,[dt_InvalidDate]
           ,[dt_EndDate]
           ,[dt_RecoveryDate]
           ,[dt_AppRightTranDate]
           ,[dt_PatentRightTranDate]
           ,[dt_InheritDate]
           ,[dt_EnforceDate]
           ,[s_Remark]
           ,[dt_OriApplicaDate]
           ,[dt_OriAuthorizeDate]
           ,[dt_ApplyStorageDate]
           ,[dt_AuthorizeStorageDate])
     VALUES
          (@s_ApplicationNO 
           ,@dt_ApplyDate 
           ,@dt_PrimaryDate 
           ,@dt_OpenDate 
           ,@dt_ActualDate 
           ,@dt_RejectDate 
           ,@dt_RetractDate 
           ,@dt_ASRetractDate
           ,@dt_AsAbandonDate
           ,@dt_AuthorizeDate 
           ,@dt_ReViewDate
           ,@dt_InvalidDate 
           ,@dt_EndDate
           ,@dt_RecoveryDate 
           ,@dt_AppRightTranDate 
           ,@dt_PatentRightTranDate 
           ,@dt_InheritDate 
           ,@dt_EnforceDate 
           ,@s_Remark
           ,@dt_OriApplicaDate
           ,@dt_OriAuthorizeDate
           ,@dt_ApplyStorageDate
           ,@dt_AuthorizeStorageDate)
          SELECT SCOPE_IDENTITY();
      ]]>
    </commandText>
    <parameters>
      <param name="@s_ApplicationNO" dbType="String"  direction="Input"/>
      <param name="@dt_ApplyDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_PrimaryDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_OpenDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_ActualDate" dbType="DateTime"  direction="Input"/>

      <param name="@dt_RejectDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_RetractDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_ASRetractDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_AsAbandonDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_AuthorizeDate" dbType="DateTime"  direction="Input"/>

      <param name="@dt_ReViewDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_InvalidDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_EndDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_RecoveryDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_AppRightTranDate" dbType="DateTime"  direction="Input"/>

      <param name="@dt_PatentRightTranDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_InheritDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_EnforceDate" dbType="DateTime"  direction="Input"/>
      <param name="@s_Remark" dbType="String"  direction="Input"/>
      <param name="@dt_OriApplicaDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_OriAuthorizeDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_ApplyStorageDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_AuthorizeStorageDate" dbType="DateTime"  direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="UpdatePatentStatusInfo" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
UPDATE [dbo].[T_PatentStatus]
   SET [s_ApplicationNO] = @s_ApplicationNO
      ,[dt_ApplyDate] = @dt_ApplyDate
      ,[dt_PrimaryDate] = @dt_PrimaryDate
      ,[dt_OpenDate] = @dt_OpenDate
      ,[dt_ActualDate] = @dt_ActualDate
      ,[dt_RejectDate] = @dt_RejectDate
      ,[dt_RetractDate] = @dt_RetractDate
      ,[dt_ASRetractDate] = @dt_ASRetractDate
      ,[dt_AsAbandonDate] = @dt_AsAbandonDate
      ,[dt_AuthorizeDate] = @dt_AuthorizeDate
      ,[dt_ReViewDate] = @dt_ReViewDate
      ,[dt_InvalidDate] = @dt_InvalidDate
      ,[dt_EndDate] = @dt_EndDate
      ,[dt_RecoveryDate] = @dt_RecoveryDate
      ,[dt_AppRightTranDate] = @dt_AppRightTranDate
      ,[dt_PatentRightTranDate] = @dt_PatentRightTranDate
      ,[dt_InheritDate] = @dt_InheritDate
      ,[dt_EnforceDate] = @dt_EnforceDate
      ,[s_Remark] = @s_Remark
      ,[dt_OriApplicaDate] = @dt_OriApplicaDate
      ,[dt_OriAuthorizeDate] = @dt_OriAuthorizeDate
      ,[dt_ApplyStorageDate] = @dt_ApplyStorageDate
      ,[dt_AuthorizeStorageDate] = @dt_AuthorizeStorageDate   
        WHERE n_ID=@n_ID
          SELECT SCOPE_IDENTITY();
      ]]>
    </commandText>
    <parameters>
      <param name="@n_ID" dbType="Int32"  direction="Input"/>
      <param name="@s_ApplicationNO" dbType="String"  direction="Input"/>
      <param name="@dt_ApplyDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_PrimaryDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_OpenDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_ActualDate" dbType="DateTime"  direction="Input"/>

      <param name="@dt_RejectDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_RetractDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_ASRetractDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_AsAbandonDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_AuthorizeDate" dbType="DateTime"  direction="Input"/>

      <param name="@dt_ReViewDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_InvalidDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_EndDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_RecoveryDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_AppRightTranDate" dbType="DateTime"  direction="Input"/>

      <param name="@dt_PatentRightTranDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_InheritDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_EnforceDate" dbType="DateTime"  direction="Input"/>
      <param name="@s_Remark" dbType="String"  direction="Input"/>
      <param name="@dt_OriApplicaDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_OriAuthorizeDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_ApplyStorageDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_AuthorizeStorageDate" dbType="DateTime"  direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="UpdatePatentStatusInfo2" database="MDATA2" commandType="Text">
    <commandText>
      <![CDATA[ 
UPDATE [dbo].[T_PatentStatus]
   SET [s_ApplicationNO] = @s_ApplicationNO
      ,[dt_ApplyDate] = @dt_ApplyDate
      ,[dt_PrimaryDate] = @dt_PrimaryDate
      ,[dt_OpenDate] = @dt_OpenDate
      ,[dt_ActualDate] = @dt_ActualDate
      ,[dt_RejectDate] = @dt_RejectDate
      ,[dt_RetractDate] = @dt_RetractDate
      ,[dt_ASRetractDate] = @dt_ASRetractDate
      ,[dt_AsAbandonDate] = @dt_AsAbandonDate
      ,[dt_AuthorizeDate] = @dt_AuthorizeDate
      ,[dt_ReViewDate] = @dt_ReViewDate
      ,[dt_InvalidDate] = @dt_InvalidDate
      ,[dt_EndDate] = @dt_EndDate
      ,[dt_RecoveryDate] = @dt_RecoveryDate
      ,[dt_AppRightTranDate] = @dt_AppRightTranDate
      ,[dt_PatentRightTranDate] = @dt_PatentRightTranDate
      ,[dt_InheritDate] = @dt_InheritDate
      ,[dt_EnforceDate] = @dt_EnforceDate
      ,[s_Remark] = @s_Remark
      ,[dt_OriApplicaDate] = @dt_OriApplicaDate
      ,[dt_OriAuthorizeDate] = @dt_OriAuthorizeDate
      ,[dt_ApplyStorageDate] = @dt_ApplyStorageDate
      ,[dt_AuthorizeStorageDate] = @dt_AuthorizeStorageDate   
        WHERE n_ID=@n_ID
          SELECT SCOPE_IDENTITY();
      ]]>
    </commandText>
    <parameters>
      <param name="@n_ID" dbType="Int32"  direction="Input"/>
      <param name="@s_ApplicationNO" dbType="String"  direction="Input"/>
      <param name="@dt_ApplyDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_PrimaryDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_OpenDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_ActualDate" dbType="DateTime"  direction="Input"/>

      <param name="@dt_RejectDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_RetractDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_ASRetractDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_AsAbandonDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_AuthorizeDate" dbType="DateTime"  direction="Input"/>

      <param name="@dt_ReViewDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_InvalidDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_EndDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_RecoveryDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_AppRightTranDate" dbType="DateTime"  direction="Input"/>

      <param name="@dt_PatentRightTranDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_InheritDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_EnforceDate" dbType="DateTime"  direction="Input"/>
      <param name="@s_Remark" dbType="String"  direction="Input"/>
      <param name="@dt_OriApplicaDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_OriAuthorizeDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_ApplyStorageDate" dbType="DateTime"  direction="Input"/>
      <param name="@dt_AuthorizeStorageDate" dbType="DateTime"  direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="GetGDPAPatentStatusByAppNO" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
SELECT [n_ID]
      ,[s_ApplicationNO]
      ,[dt_ApplyDate]
      ,[dt_PrimaryDate]
      ,[dt_OpenDate]
      ,[dt_ActualDate]
      ,[dt_RejectDate]
      ,[dt_RetractDate]
      ,[dt_ASRetractDate]
      ,[dt_AsAbandonDate]
      ,[dt_AuthorizeDate]
      ,[dt_ReViewDate]
      ,[dt_InvalidDate]
      ,[dt_EndDate]
      ,[dt_RecoveryDate]
      ,[dt_AppRightTranDate]
      ,[dt_PatentRightTranDate]
      ,[dt_InheritDate]
      ,[dt_EnforceDate]
      ,[s_Remark]
      ,[dt_OriApplicaDate]
      ,[dt_OriAuthorizeDate]
      ,[dt_ApplyStorageDate]
      ,[dt_AuthorizeStorageDate]   
  FROM [dbo].[T_PatentStatus] WITH(NOLOCK)
      WHERE s_ApplicationNO=@ApplicationNo  
      ]]>
    </commandText>
    <parameters>
      <param name="@ApplicationNo" dbType="AnsiStringFixedLength" direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="GetGDPAPatentStatusByAppNO2" database="MDATA2" commandType="Text">
    <commandText>
      <![CDATA[ 
SELECT [n_ID]
      ,[s_ApplicationNO]
      ,[dt_ApplyDate]
      ,[dt_PrimaryDate]
      ,[dt_OpenDate]
      ,[dt_ActualDate]
      ,[dt_RejectDate]
      ,[dt_RetractDate]
      ,[dt_ASRetractDate]
      ,[dt_AsAbandonDate]
      ,[dt_AuthorizeDate]
      ,[dt_ReViewDate]
      ,[dt_InvalidDate]
      ,[dt_EndDate]
      ,[dt_RecoveryDate]
      ,[dt_AppRightTranDate]
      ,[dt_PatentRightTranDate]
      ,[dt_InheritDate]
      ,[dt_EnforceDate]
      ,[s_Remark]
      ,[dt_OriApplicaDate]
      ,[dt_OriAuthorizeDate]
      ,[dt_ApplyStorageDate]
      ,[dt_AuthorizeStorageDate]   
  FROM [dbo].[T_PatentStatus] WITH(NOLOCK)
      WHERE s_ApplicationNO=@ApplicationNo  
      ]]>
    </commandText>
    <parameters>
      <param name="@ApplicationNo" dbType="AnsiStringFixedLength" direction="Input"/>
    </parameters>
  </dataCommand>
  <!--申请，授权，有效数据表 T_Agency-->
  <dataCommand name="InsertAgencyInfo" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
INSERT INTO [dbo].[T_Agency]
           ([s_NO]
           ,[s_Name]
           ,[s_Zip]
           ,[s_Address]
           ,[s_Country]
           ,[s_Province]
           ,[s_City]
           ,[s_Area]
           ,[s_Tel]
           ,[s_Email]
           ,[s_Corporation]
           ,[s_Remark])
     VALUES
           (@s_NO
           ,@s_Name
           ,@s_Zip
           ,@s_Address
           ,@s_Country
           ,@s_Province
           ,@s_City
           ,@s_Area
           ,@s_Tel
           ,@s_Email
           ,@s_Corporation
           ,@s_Remark)
          SELECT SCOPE_IDENTITY();
      ]]>
    </commandText>
    <parameters>
      <param name="@s_NO" dbType="String"  direction="Input"/>
      <param name="@s_Name" dbType="String"  direction="Input"/>
      <param name="@s_Zip" dbType="String"  direction="Input"/>
      <param name="@s_Address" dbType="String"  direction="Input"/>
      <param name="@s_Country" dbType="String"  direction="Input"/>

      <param name="@s_Province" dbType="String"  direction="Input"/>
      <param name="@s_City" dbType="String"  direction="Input"/>
      <param name="@s_Area" dbType="String"  direction="Input"/>
      <param name="@s_Tel" dbType="String"  direction="Input"/>
      <param name="@s_Email" dbType="String"  direction="Input"/>

      <param name="@s_Corporation" dbType="String"  direction="Input"/>
      <param name="@s_Remark" dbType="String"  direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="InsertAgencyInfo2" database="MDATA2" commandType="Text">
    <commandText>
      <![CDATA[ 
INSERT INTO [dbo].[T_Agency]
           ([s_NO]
           ,[s_Name]
           ,[s_Zip]
           ,[s_Address]
           ,[s_Country]
           ,[s_Province]
           ,[s_City]
           ,[s_Area]
           ,[s_Tel]
           ,[s_Email]
           ,[s_Corporation]
           ,[s_Remark])
     VALUES
           (@s_NO
           ,@s_Name
           ,@s_Zip
           ,@s_Address
           ,@s_Country
           ,@s_Province
           ,@s_City
           ,@s_Area
           ,@s_Tel
           ,@s_Email
           ,@s_Corporation
           ,@s_Remark)
          SELECT SCOPE_IDENTITY();
      ]]>
    </commandText>
    <parameters>
      <param name="@s_NO" dbType="String"  direction="Input"/>
      <param name="@s_Name" dbType="String"  direction="Input"/>
      <param name="@s_Zip" dbType="String"  direction="Input"/>
      <param name="@s_Address" dbType="String"  direction="Input"/>
      <param name="@s_Country" dbType="String"  direction="Input"/>

      <param name="@s_Province" dbType="String"  direction="Input"/>
      <param name="@s_City" dbType="String"  direction="Input"/>
      <param name="@s_Area" dbType="String"  direction="Input"/>
      <param name="@s_Tel" dbType="String"  direction="Input"/>
      <param name="@s_Email" dbType="String"  direction="Input"/>

      <param name="@s_Corporation" dbType="String"  direction="Input"/>
      <param name="@s_Remark" dbType="String"  direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="UpdateAgencyInfo" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
UPDATE [dbo].[T_Agency]
   SET [s_NO] = @s_NO
      ,[s_Name] = @s_Name
      ,[s_Zip] = @s_Zip
      ,[s_Address] = @s_Address
      ,[s_Country] = @s_Country
      ,[s_Province] = @s_Province
      ,[s_City] = @s_City
      ,[s_Area] = @s_Area
      ,[s_Tel] = @s_Tel
      ,[s_Email] = @s_Email
      ,[s_Corporation] = @s_Corporation
      ,[s_Remark] = @s_Remark
        WHERE n_ID=@n_ID
          SELECT SCOPE_IDENTITY();
      ]]>
    </commandText>
    <parameters>
      <param name="@n_ID" dbType="Int64"  direction="Input"/>
      <param name="@s_NO" dbType="String"  direction="Input"/>
      <param name="@s_Name" dbType="String"  direction="Input"/>
      <param name="@s_Zip" dbType="String"  direction="Input"/>
      <param name="@s_Address" dbType="String"  direction="Input"/>
      <param name="@s_Country" dbType="String"  direction="Input"/>

      <param name="@s_Province" dbType="String"  direction="Input"/>
      <param name="@s_City" dbType="String"  direction="Input"/>
      <param name="@s_Area" dbType="String"  direction="Input"/>
      <param name="@s_Tel" dbType="String"  direction="Input"/>
      <param name="@s_Email" dbType="String"  direction="Input"/>

      <param name="@s_Corporation" dbType="String"  direction="Input"/>
      <param name="@s_Remark" dbType="String"  direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="UpdateAgencyInfo2" database="MDATA2" commandType="Text">
    <commandText>
      <![CDATA[ 
UPDATE [dbo].[T_Agency]
   SET [s_NO] = @s_NO
      ,[s_Name] = @s_Name
      ,[s_Zip] = @s_Zip
      ,[s_Address] = @s_Address
      ,[s_Country] = @s_Country
      ,[s_Province] = @s_Province
      ,[s_City] = @s_City
      ,[s_Area] = @s_Area
      ,[s_Tel] = @s_Tel
      ,[s_Email] = @s_Email
      ,[s_Corporation] = @s_Corporation
      ,[s_Remark] = @s_Remark
        WHERE n_ID=@n_ID
          SELECT SCOPE_IDENTITY();
      ]]>
    </commandText>
    <parameters>
      <param name="@n_ID" dbType="Int64"  direction="Input"/>
      <param name="@s_NO" dbType="String"  direction="Input"/>
      <param name="@s_Name" dbType="String"  direction="Input"/>
      <param name="@s_Zip" dbType="String"  direction="Input"/>
      <param name="@s_Address" dbType="String"  direction="Input"/>
      <param name="@s_Country" dbType="String"  direction="Input"/>

      <param name="@s_Province" dbType="String"  direction="Input"/>
      <param name="@s_City" dbType="String"  direction="Input"/>
      <param name="@s_Area" dbType="String"  direction="Input"/>
      <param name="@s_Tel" dbType="String"  direction="Input"/>
      <param name="@s_Email" dbType="String"  direction="Input"/>

      <param name="@s_Corporation" dbType="String"  direction="Input"/>
      <param name="@s_Remark" dbType="String"  direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="GetAgencyNO" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
SELECT [n_ID]
      ,[s_NO]
      ,[s_Name]
      ,[s_Zip]
      ,[s_Address]
      ,[s_Country]
      ,[s_Province]
      ,[s_City]
      ,[s_Area]
      ,[s_Tel]
      ,[s_Email]
      ,[s_Corporation]
      ,[s_Remark]
  FROM [dbo].[T_Agency] WITH(NOLOCK)
      WHERE s_NO=@s_NO
      ]]>
    </commandText>
    <parameters>
      <param name="@s_NO" dbType="AnsiStringFixedLength" direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="GetAgencyNO2" database="MDATA2" commandType="Text">
    <commandText>
      <![CDATA[ 
SELECT [n_ID]
      ,[s_NO]
      ,[s_Name]
      ,[s_Zip]
      ,[s_Address]
      ,[s_Country]
      ,[s_Province]
      ,[s_City]
      ,[s_Area]
      ,[s_Tel]
      ,[s_Email]
      ,[s_Corporation]
      ,[s_Remark]
  FROM [dbo].[T_Agency] WITH(NOLOCK)
      WHERE s_NO=@s_NO
      ]]>
    </commandText>
    <parameters>
      <param name="@s_NO" dbType="AnsiStringFixedLength" direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="GetGDPACityBaseData" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
SELECT 
      [s_Year]
      ,[s_PatentType]
      ,[s_CityName]
      ,[n_Count]
  FROM [GDPA_One].[dbo].[T_PatentCityBaseData] group by s_Year,[s_PatentType],[s_CityName],[n_Count]
      ]]>
    </commandText>
  </dataCommand>
  <!--申请，授权，有效数据表 T_PlanningDivisionData-->
  <dataCommand name="GetPlanningDivisionById" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
SELECT [n_ID]
      ,[s_ApplicationNo]
      ,[s_ApplyStorageDate]
      ,[s_AuthorizeStorageDate]
      ,[s_ApplicationDate]
      ,[s_PatentName]
      ,[s_PatentType]
      ,[s_ApplyMethod]
      ,[s_IpcCategory]
      ,[s_ApplicantName]
      ,[n_ApplicantType]
      ,[n_ApplicantSeq]
      ,[s_ApplicantAddr]
      ,[s_ApplicantZip]
      ,[s_ApplicantTel]
      ,[s_ApplicantCountry]
      ,[s_ApplicantProvince]
      ,[s_ApplicantCity]
      ,[s_ApplicantArea]
      ,[s_PatenteeName]
      ,[s_PatenteeType]
      ,[s_PatenteeSeq]
      ,[s_PatenteeAddr]
      ,[s_PatenteeZip]
      ,[s_PatenteeTel]
      ,[s_PatenteeCountry]
      ,[s_PatenteeProvince]
      ,[s_PatenteeCity]
      ,[s_PatenteeArea]
      ,[s_AgencyCode]
      ,[s_AgencyName]
      ,[dt_RecordDate]
      ,[s_RecordType]
      ,[s_ObtainDate]
      ,[n_PlainningDivisionTF]
      ,[n_InvalidTF]
      ,[dt_InvalidDate]
      ,[s_InvalidCause]
  FROM  [dbo].[T_PlanningDivisionData] WITH(NOLOCK)
      WHERE n_ID=@ID
      ]]>
    </commandText>
    <parameters>
      <param name="@ID" dbType="Int32" direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="GetGDPAPlanningDivisionByAppID" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
SELECT [n_ID]
      ,[s_ApplicationNo]
      ,[s_ApplyStorageDate]
      ,[s_AuthorizeStorageDate]
      ,[s_ApplicationDate]
      ,[s_PatentName]
      ,[s_PatentType]
      ,[s_ApplyMethod]
      ,[s_IpcCategory]
      ,[s_ApplicantName]
      ,[n_ApplicantType]
      ,[n_ApplicantSeq]
      ,[s_ApplicantAddr]
      ,[s_ApplicantZip]
      ,[s_ApplicantTel]
      ,[s_ApplicantCountry]
      ,[s_ApplicantProvince]
      ,[s_ApplicantCity]
      ,[s_ApplicantArea]
      ,[s_PatenteeName]
      ,[s_PatenteeType]
      ,[s_PatenteeSeq]
      ,[s_PatenteeAddr]
      ,[s_PatenteeZip]
      ,[s_PatenteeTel]
      ,[s_PatenteeCountry]
      ,[s_PatenteeProvince]
      ,[s_PatenteeCity]
      ,[s_PatenteeArea]
      ,[s_AgencyCode]
      ,[s_AgencyName]
      ,[dt_RecordDate]
      ,[s_RecordType]
      ,[s_ObtainDate]
      ,[n_PlainningDivisionTF]
      ,[n_InvalidTF]
      ,[dt_InvalidDate]
      ,[s_InvalidCause]
  FROM  [dbo].[T_PlanningDivisionData] WITH(NOLOCK)
      WHERE s_ApplicationNo=@ApplicationNo
      ]]>
    </commandText>
    <parameters>
      <param name="@ApplicationNo" dbType="AnsiStringFixedLength" direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="GetPlanningDivisionByAppIDAndIPC" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
SELECT [n_ID]
      ,[s_ApplicationNo]
      ,[s_ApplyStorageDate]
      ,[s_AuthorizeStorageDate]
      ,[s_ApplicationDate]
      ,[s_PatentName]
      ,[s_PatentType]
      ,[s_ApplyMethod]
      ,[s_IpcCategory]
      ,[s_ApplicantName]
      ,[n_ApplicantType]
      ,[n_ApplicantSeq]
      ,[s_ApplicantAddr]
      ,[s_ApplicantZip]
      ,[s_ApplicantTel]
      ,[s_ApplicantCountry]
      ,[s_ApplicantProvince]
      ,[s_ApplicantCity]
      ,[s_ApplicantArea]
      ,[s_PatenteeName]
      ,[s_PatenteeType]
      ,[s_PatenteeSeq]
      ,[s_PatenteeAddr]
      ,[s_PatenteeZip]
      ,[s_PatenteeTel]
      ,[s_PatenteeCountry]
      ,[s_PatenteeProvince]
      ,[s_PatenteeCity]
      ,[s_PatenteeArea]
      ,[s_AgencyCode]
      ,[s_AgencyName]
      ,[dt_RecordDate]
      ,[s_RecordType]
      ,[s_ObtainDate]
      ,[n_PlainningDivisionTF]
      ,[n_InvalidTF]
      ,[dt_InvalidDate]
      ,[s_InvalidCause]
  FROM  [dbo].[T_PlanningDivisionData] WITH(NOLOCK)
      WHERE s_ApplicationNo=@ApplicationNo
      AND s_IpcCategory=@IPC 
      ]]>
    </commandText>
    <parameters>
      <param name="@ApplicationNo" dbType="AnsiStringFixedLength" direction="Input"/>
      <param name="@IPC" dbType="AnsiStringFixedLength" direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="CheckAppInfoExisted" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
SELECT  COUNT(1)
  FROM  [dbo].[T_PlanningDivisionData] WITH(NOLOCK)
      WHERE s_ApplicationNo=@ApplicationNo
      ]]>
    </commandText>
    <parameters>
      <param name="@ApplicationNo" dbType="AnsiStringFixedLength" direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="GetPlanningDivisionByQuery" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
    SELECT @TotalCount = COUNT(1)
   FROM  [dbo].[T_PlanningDivisionData] WITH(NOLOCK)
   #StrWhere#
 SELECT 
      [n_ID]
      ,[s_ApplicationNo]
      ,[s_ApplyStorageDate]
      ,[s_AuthorizeStorageDate]
      ,[s_ApplicationDate]
      ,[s_PatentName]
      ,[s_PatentType]
      ,[s_ApplyMethod]
      ,[s_IpcCategory]
      ,[s_ApplicantName]
      ,[n_ApplicantType]
      ,[n_ApplicantSeq]
      ,[s_ApplicantAddr]
      ,[s_ApplicantZip]
      ,[s_ApplicantTel]
      ,[s_ApplicantCountry]
      ,[s_ApplicantProvince]
      ,[s_ApplicantCity]
      ,[s_ApplicantArea]
      ,[s_PatenteeName]
      ,[s_PatenteeType]
      ,[s_PatenteeSeq]
      ,[s_PatenteeAddr]
      ,[s_PatenteeZip]
      ,[s_PatenteeTel]
      ,[s_PatenteeCountry]
      ,[s_PatenteeProvince]
      ,[s_PatenteeCity]
      ,[s_PatenteeArea]
      ,[s_AgencyCode]
      ,[s_AgencyName]
      ,[dt_RecordDate]
      ,[s_RecordType]
      ,[s_ObtainDate]
      ,[n_PlainningDivisionTF]
      ,[n_InvalidTF]
      ,[dt_InvalidDate]
      ,[s_InvalidCause]
      FROM (
 SELECT TOP (@EndNumber) RowNumber=ROW_NUMBER() OVER(ORDER BY #SortColumnName#)
      ,[n_ID]
      ,[s_ApplicationNo]
      ,[s_ApplyStorageDate]
      ,[s_AuthorizeStorageDate]
      ,[s_ApplicationDate]
      ,[s_PatentName]
      ,[s_PatentType]
      ,[s_ApplyMethod]
      ,[s_IpcCategory]
      ,[s_ApplicantName]
      ,[n_ApplicantType]
      ,[n_ApplicantSeq]
      ,[s_ApplicantAddr]
      ,[s_ApplicantZip]
      ,[s_ApplicantTel]
      ,[s_ApplicantCountry]
      ,[s_ApplicantProvince]
      ,[s_ApplicantCity]
      ,[s_ApplicantArea]
      ,[s_PatenteeName]
      ,[s_PatenteeType]
      ,[s_PatenteeSeq]
      ,[s_PatenteeAddr]
      ,[s_PatenteeZip]
      ,[s_PatenteeTel]
      ,[s_PatenteeCountry]
      ,[s_PatenteeProvince]
      ,[s_PatenteeCity]
      ,[s_PatenteeArea]
      ,[s_AgencyCode]
      ,[s_AgencyName]
      ,[dt_RecordDate]
      ,[s_RecordType]
      ,[s_ObtainDate]
      ,[n_PlainningDivisionTF]
      ,[n_InvalidTF]
      ,[dt_InvalidDate]
      ,[s_InvalidCause]
  FROM [dbo].[T_PlanningDivisionData]
   #StrWhere#
    ) R
  WHERE
     RowNumber>@StartNumber
      ]]>
    </commandText>
  </dataCommand>
  <dataCommand name="InsertPlanningDivision" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
INSERT INTO [dbo].[T_PlanningDivisionData]
           ([s_ApplicationNo]
           ,[s_ApplyStorageDate]
           ,[s_AuthorizeStorageDate]
           ,[s_ApplicationDate]
           ,[s_PatentName]
           ,[s_PatentType]
           ,[s_ApplyMethod]
           ,[s_IpcCategory]
           ,[s_ApplicantName]
           ,[n_ApplicantType]
           ,[n_ApplicantSeq]
           ,[s_ApplicantAddr]
           ,[s_ApplicantZip]
           ,[s_ApplicantTel]
           ,[s_ApplicantCountry]
           ,[s_ApplicantProvince]
           ,[s_ApplicantCity]
           ,[s_ApplicantArea]
           ,[s_PatenteeName]
           ,[s_PatenteeType]
           ,[s_PatenteeSeq]
           ,[s_PatenteeAddr]
           ,[s_PatenteeZip]
           ,[s_PatenteeTel]
           ,[s_PatenteeCountry]
           ,[s_PatenteeProvince]
           ,[s_PatenteeCity]
           ,[s_PatenteeArea]
           ,[s_AgencyCode]
           ,[s_AgencyName]
           ,[dt_RecordDate]
           ,[s_RecordType]
           ,[s_ObtainDate]
           ,[n_PlainningDivisionTF]
           ,[n_InvalidTF]
           ,[dt_InvalidDate]
           ,[s_InvalidCause])
     VALUES
          (@s_ApplicationNo 
           ,@s_ApplyStorageDate 
           ,@s_AuthorizeStorageDate 
           ,@s_ApplicationDate 
           ,@s_PatentName 
           ,@s_PatentType 
           ,@s_ApplyMethod 
           ,@s_IpcCategory 
           ,@s_ApplicantName 
           ,@n_ApplicantType 
           ,@n_ApplicantSeq 
           ,@s_ApplicantAddr 
           ,@s_ApplicantZip 
           ,@s_ApplicantTel 
           ,@s_ApplicantCountry 
           ,@s_ApplicantProvince 
           ,@s_ApplicantCity 
           ,@s_ApplicantArea 
           ,@s_PatenteeName 
           ,@s_PatenteeType 
           ,@s_PatenteeSeq 
           ,@s_PatenteeAddr 
           ,@s_PatenteeZip 
           ,@s_PatenteeTel 
           ,@s_PatenteeCountry 
           ,@s_PatenteeProvince 
           ,@s_PatenteeCity 
           ,@s_PatenteeArea 
           ,@s_AgencyCode 
           ,@s_AgencyName 
           ,@dt_RecordDate 
           ,@s_RecordType 
           ,@s_ObtainDate 
           ,@n_PlainningDivisionTF 
           ,@n_InvalidTF 
           ,@dt_InvalidDate 
           ,@s_InvalidCause )
          SELECT SCOPE_IDENTITY();
      ]]>
    </commandText>
    <parameters>
      <param name="@s_ApplicationNo" dbType="String"  direction="Input"/>
      <param name="@s_ApplyStorageDate" dbType="String"  direction="Input"/>
      <param name="@s_AuthorizeStorageDate" dbType="String"  direction="Input"/>
      <param name="@s_ApplicationDate" dbType="String"  direction="Input"/>
      <param name="@s_PatentName" dbType="String"  direction="Input"/>

      <param name="@s_PatentType" dbType="String"  direction="Input"/>
      <param name="@s_ApplyMethod" dbType="String"  direction="Input"/>
      <param name="@s_IpcCategory" dbType="String"  direction="Input"/>
      <param name="@s_ApplicantName" dbType="String"  direction="Input"/>
      <param name="@n_ApplicantType" dbType="String"  direction="Input"/>

      <param name="@n_ApplicantSeq" dbType="Int32"  direction="Input"/>
      <param name="@s_ApplicantAddr" dbType="String"  direction="Input"/>
      <param name="@s_ApplicantZip" dbType="String"  direction="Input"/>
      <param name="@s_ApplicantTel" dbType="String"  direction="Input"/>
      <param name="@s_ApplicantCountry" dbType="String"  direction="Input"/>

      <param name="@s_ApplicantProvince" dbType="String"  direction="Input"/>
      <param name="@s_ApplicantCity" dbType="String"  direction="Input"/>
      <param name="@s_ApplicantArea" dbType="String"  direction="Input"/>
      <param name="@s_PatenteeName" dbType="String"  direction="Input"/>
      <param name="@s_PatenteeType" dbType="String"  direction="Input"/>

      <param name="@s_PatenteeSeq" dbType="Int32"  direction="Input"/>
      <param name="@s_PatenteeAddr" dbType="String"  direction="Input"/>
      <param name="@s_PatenteeZip" dbType="String"  direction="Input"/>
      <param name="@s_PatenteeTel" dbType="String"  direction="Input"/>
      <param name="@s_PatenteeCountry" dbType="String"  direction="Input"/>

      <param name="@s_PatenteeProvince" dbType="String"  direction="Input"/>
      <param name="@s_PatenteeCity" dbType="String"  direction="Input"/>
      <param name="@s_PatenteeArea" dbType="String"  direction="Input"/>
      <param name="@s_AgencyCode" dbType="String"  direction="Input"/>
      <param name="@s_AgencyName" dbType="String"  direction="Input"/>

      <param name="@dt_RecordDate" dbType="DateTime"  direction="Input"/>
      <param name="@s_RecordType" dbType="String"  direction="Input"/>
      <param name="@s_ObtainDate" dbType="String"  direction="Input"/>
      <param name="@n_PlainningDivisionTF" dbType="String"  direction="Input"/>
      <param name="@n_InvalidTF" dbType="Int32"  direction="Input"/>

      <param name="@dt_InvalidDate" dbType="DateTime"  direction="Input"/>
      <param name="@s_InvalidCause" dbType="String"  direction="Input"/>

    </parameters>
  </dataCommand>
  <dataCommand name="UpdatePlanningDivision" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
UPDATE  [dbo].[T_PlanningDivisionData]
   SET [s_ApplicationNo] = @s_ApplicationNo
      ,[s_ApplyStorageDate] = @s_ApplyStorageDate
      ,[s_AuthorizeStorageDate] = @s_AuthorizeStorageDate
      ,[s_ApplicationDate] = @s_ApplicationDate
      ,[s_PatentName] = @s_PatentName
      ,[s_PatentType] = @s_PatentType 
      ,[s_ApplyMethod] = @s_ApplyMethod
      ,[s_IpcCategory] = @s_IpcCategory
      ,[s_ApplicantName] = @s_ApplicantName
      ,[n_ApplicantType] = @n_ApplicantType
      ,[n_ApplicantSeq] = @n_ApplicantSeq
      ,[s_ApplicantAddr] = @s_ApplicantAddr
      ,[s_ApplicantZip] = @s_ApplicantZip
      ,[s_ApplicantTel] = @s_ApplicantTel
      ,[s_ApplicantCountry] = @s_ApplicantCountry
      ,[s_ApplicantProvince] = @s_ApplicantProvince
      ,[s_ApplicantCity] = @s_ApplicantCity
      ,[s_ApplicantArea] = @s_ApplicantArea
      ,[s_PatenteeName] = @s_PatenteeName
      ,[s_PatenteeType] = @s_PatenteeType
      ,[s_PatenteeSeq] = @s_PatenteeSeq
      ,[s_PatenteeAddr] = @s_PatenteeAddr
      ,[s_PatenteeZip] = @s_PatenteeZip
      ,[s_PatenteeTel] = @s_PatenteeTel
      ,[s_PatenteeCountry] = @s_PatenteeCountry
      ,[s_PatenteeProvince] = @s_PatenteeProvince
      ,[s_PatenteeCity] = @s_PatenteeCity
      ,[s_PatenteeArea] = @s_PatenteeArea
      ,[s_AgencyCode] = @s_AgencyCode
      ,[s_AgencyName] = @s_AgencyName
      ,[dt_RecordDate] = @dt_RecordDate
      ,[s_RecordType] = @s_RecordType
      ,[s_ObtainDate] = @s_ObtainDate
      ,[n_PlainningDivisionTF] = @n_PlainningDivisionTF
      ,[n_InvalidTF] = @n_InvalidTF
      ,[dt_InvalidDate] = @dt_InvalidDate
      ,[s_InvalidCause] = @s_InvalidCause
                  WHERE n_ID=@n_ID
      SELECT SCOPE_IDENTITY();
      ]]>
    </commandText>
    <parameters>
      <param name="@n_ID" dbType="Int32"  direction="Input"/>
      <param name="@s_ApplicationNo" dbType="AnsiStringFixedLength"  direction="Input"/>
      <param name="@s_ApplyStorageDate" dbType="AnsiStringFixedLength"  direction="Input"/>
      <param name="@s_AuthorizeStorageDate" dbType="AnsiStringFixedLength"  direction="Input"/>
      <param name="@s_ApplicationDate" dbType="AnsiStringFixedLength"  direction="Input"/>
      <param name="@s_PatentName" dbType="AnsiStringFixedLength"  direction="Input"/>

      <param name="@s_PatentType" dbType="AnsiStringFixedLength"  direction="Input"/>
      <param name="@s_ApplyMethod" dbType="AnsiStringFixedLength"  direction="Input"/>
      <param name="@s_IpcCategory" dbType="AnsiStringFixedLength"  direction="Input"/>
      <param name="@s_ApplicantName" dbType="AnsiStringFixedLength"  direction="Input"/>
      <param name="@n_ApplicantType" dbType="AnsiStringFixedLength"  direction="Input"/>

      <param name="@n_ApplicantSeq" dbType="Int32"  direction="Input"/>
      <param name="@s_ApplicantAddr" dbType="AnsiStringFixedLength"  direction="Input"/>
      <param name="@s_ApplicantZip" dbType="AnsiStringFixedLength"  direction="Input"/>
      <param name="@s_ApplicantTel" dbType="AnsiStringFixedLength"  direction="Input"/>
      <param name="@s_ApplicantCountry" dbType="AnsiStringFixedLength"  direction="Input"/>

      <param name="@s_ApplicantProvince" dbType="AnsiStringFixedLength"  direction="Input"/>
      <param name="@s_ApplicantCity" dbType="AnsiStringFixedLength"  direction="Input"/>
      <param name="@s_ApplicantArea" dbType="AnsiStringFixedLength"  direction="Input"/>
      <param name="@s_PatenteeName" dbType="AnsiStringFixedLength"  direction="Input"/>
      <param name="@s_PatenteeType" dbType="AnsiStringFixedLength"  direction="Input"/>

      <param name="@s_PatenteeSeq" dbType="Int32"  direction="Input"/>
      <param name="@s_PatenteeAddr" dbType="AnsiStringFixedLength"  direction="Input"/>
      <param name="@s_PatenteeZip" dbType="AnsiStringFixedLength"  direction="Input"/>
      <param name="@s_PatenteeTel" dbType="AnsiStringFixedLength"  direction="Input"/>
      <param name="@s_PatenteeCountry" dbType="AnsiStringFixedLength"  direction="Input"/>

      <param name="@s_PatenteeProvince" dbType="AnsiStringFixedLength"  direction="Input"/>
      <param name="@s_PatenteeCity" dbType="AnsiStringFixedLength"  direction="Input"/>
      <param name="@s_PatenteeArea" dbType="AnsiStringFixedLength"  direction="Input"/>
      <param name="@s_AgencyCode" dbType="AnsiStringFixedLength"  direction="Input"/>
      <param name="@s_AgencyName" dbType="AnsiStringFixedLength"  direction="Input"/>

      <param name="@dt_RecordDate" dbType="DateTime"  direction="Input"/>
      <param name="@s_RecordType" dbType="AnsiStringFixedLength"  direction="Input"/>
      <param name="@s_ObtainDate" dbType="AnsiStringFixedLength"  direction="Input"/>
      <param name="@n_PlainningDivisionTF" dbType="AnsiStringFixedLength"  direction="Input"/>
      <param name="@n_InvalidTF" dbType="Int32"  direction="Input"/>

      <param name="@dt_InvalidDate" dbType="DateTime"  direction="Input"/>
      <param name="@s_InvalidCause" dbType="AnsiStringFixedLength"  direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="DeletePlanningDivisionByID" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
      DELETE T_PlanningDivisionData
          WHERE n_ID=@n_ID
      ]]>
    </commandText>
    <parameters>
      <param name="@n_ID" dbType="Int32" direction="Input"/>
    </parameters>
  </dataCommand>

  <!--查询PCT国际数据表 T_PCTApplication-->
  <dataCommand name="GetPCTApplicationByQuery" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
    SELECT @TotalCount = COUNT(1)
   FROM  [dbo].[T_PCTApplication] WITH(NOLOCK)
   #StrWhere# 
   
   IF EXISTS  (SELECT  * FROM dbo.SysObjects WHERE ID = object_id(N'[_TD]') AND OBJECTPROPERTY(ID, 'IsTable') = 1) 
   BEGIN
		    DROP TABLE _TD   
	 END
   
   SELECT RowNumber=ROW_NUMBER() OVER(ORDER BY A.n_ID DESC) 
				 ,A.n_ID  
	   INTO _TD
	   FROM T_PCTApplication A 
       #StrWhere#   

CREATE NONCLUSTERED INDEX IX_TD_ROWNUM ON _TD(RowNumber)   

SELECT A.n_ID, 
      A.s_ApplicationNo, 
      s_ReceiveDate, 
      IPC.s_IpcCategory,
      s_ApplicantName, 
      s_ApplicantCountryCN, 
      s_ApplicantProvinceCN, 
      s_ApplicantCityCN, 
      s_ApplicantAreaCN, 
      s_ApplicantStreetCN, 
      s_ApplicantCountryEN, 
      s_ApplicantProvinceEN, 
      s_ApplicantCityEN, 
      s_ApplicantAreaEN, 
      s_ApplicantStreetEN, 
      s_PatentName,
      s_ApplyDateWorld,
      d_ImportDate    
      FROM T_PCTApplication A 
      inner join _TD TD on TD.n_ID=A.n_ID
      left join (SELECT s_ApplicationNO as appNo, 
STUFF(
     ( 
      SELECT ';'+ s_IpcCategory FROM T_ApplyNoToIPC t WHERE b.s_ApplicationNO = t.s_ApplicationNO FOR XML PATH('')
     ),1 ,1, '') s_IpcCategory 
FROM T_ApplyNoToIPC b 
GROUP BY s_ApplicationNO) as IPC on IPC.appNo=A.s_ApplicationNo   
WHERE RowNumber BETWEEN @StartNumber + 1 AND @EndNumber   

DROP TABLE _TD   

      ]]>
    </commandText>
  </dataCommand>

  <!--插入PCT国际数据表 T_PCTApplication-->
  <dataCommand name="InsertPCTApplication" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
    INSERT INTO  [dbo].[T_PCTApplication] 
     (s_ApplicationNo, 
      s_ReceiveDate, 
      d_Year,
      d_Month,
      s_IpcCategory,
      s_ApplicantName,
      s_ApplicantCountryCN, 
      s_ApplicantProvinceCN, 
      s_ApplicantCityCN, 
      s_ApplicantStreetCN, 
      s_ApplicantCityEN, 
      s_ApplicantStreetEN,
      s_PatentName,
      s_ApplyDateWorld,
      d_ImportDate) 
      VALUES 
      (@s_ApplicationNo 
           ,@s_ReceiveDate 
           ,@d_Year
           ,@d_Month
           ,@s_IpcCategory 
           ,@s_ApplicantName
           ,@s_ApplicantCountryCN 
           ,@s_ApplicantProvinceCN 
           ,@s_ApplicantCityCN 
           ,@s_ApplicantStreetCN 
           ,@s_ApplicantCityEN 
           ,@s_ApplicantStreetEN
           ,@s_PatentName
           ,@s_ApplyDateWorld
           ,@d_ImportDate) 
      SELECT SCOPE_IDENTITY();  
      ]]>
    </commandText>
    <parameters>
      <param name="@s_ApplicationNo" dbType="String"  direction="Input"/>
      <param name="@s_ReceiveDate" dbType="String"  direction="Input"/>
      <param name="@d_Year" dbType="String"  direction="Input"/>
      <param name="@d_Month" dbType="String"  direction="Input"/>
      <param name="@s_IpcCategory" dbType="String"  direction="Input"/>
      <param name="@s_ApplicantName" dbType="String"  direction="Input"/>
      <!--<param name="@s_ApplicantSeq" dbType="String"  direction="Input"/>-->
      <param name="@s_ApplicantCountryCN" dbType="String"  direction="Input"/>
      <param name="@s_ApplicantProvinceCN" dbType="String"  direction="Input"/>
      <param name="@s_ApplicantCityCN" dbType="String"  direction="Input"/>
      <!--<param name="@s_ApplicantAreaCN" dbType="String"  direction="Input"/>-->
      <param name="@s_ApplicantStreetCN" dbType="String"  direction="Input"/>
      <!--<param name="@s_ApplicantCountryEN" dbType="String"  direction="Input"/>
      <param name="@s_ApplicantProvinceEN" dbType="String"  direction="Input"/>-->
      <param name="@s_ApplicantCityEN" dbType="String"  direction="Input"/>
      <!--<param name="@s_ApplicantAreaEN" dbType="String"  direction="Input"/>-->
      <param name="@s_ApplicantStreetEN" dbType="String"  direction="Input"/>
      <param name="@s_PatentName" dbType="String"  direction="Input"/>
      <param name="@s_ApplyDateWorld" dbType="String"  direction="Input"/>
      <param name="@d_ImportDate" dbType="String"  direction="Input"/>
    </parameters>
  </dataCommand>

  <!--根据appNo获取数据表 T_PCTApplication-->
  <dataCommand name="GetGDPAPCTApplicationByAppID" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
  SELECT [n_ID], 
      [s_ApplicationNo], 
      [s_ReceiveDate], 
      [d_Year],
      [d_Month],
      [s_IpcCategory],
      [s_ApplicantName], 
      [s_ApplicantCountryCN], 
      [s_ApplicantProvinceCN], 
      [s_ApplicantCityCN], 
      [s_ApplicantAreaCN], 
      [s_ApplicantStreetCN], 
      [s_ApplicantCountryEN], 
      [s_ApplicantProvinceEN], 
      [s_ApplicantCityEN], 
      [s_ApplicantAreaEN], 
      [s_ApplicantStreetEN], 
      [s_PatentName],
      [s_ApplyDateWorld],
      [d_ImportDate]   
  FROM  [dbo].[T_PCTApplication] WITH(NOLOCK)
      WHERE s_ApplicationNo=@s_ApplicationNo  
      ]]>
    </commandText>
    <parameters>
      <param name="@s_ApplicationNo" dbType="AnsiStringFixedLength"  direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="GetGDPAPCTApplicationByAppIDAndIPC" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
  SELECT [n_ID], 
      [s_ApplicationNo], 
      [s_ReceiveDate], 
      [d_Year],
      [d_Month],
      [s_IpcCategory],
      [s_ApplicantName], 
      [s_ApplicantCountryCN], 
      [s_ApplicantProvinceCN], 
      [s_ApplicantCityCN], 
      [s_ApplicantAreaCN], 
      [s_ApplicantStreetCN], 
      [s_ApplicantCountryEN], 
      [s_ApplicantProvinceEN], 
      [s_ApplicantCityEN], 
      [s_ApplicantAreaEN], 
      [s_ApplicantStreetEN], 
      [s_PatentName],
      [s_ApplyDateWorld] 
  FROM  [dbo].[T_PCTApplication] WITH(NOLOCK)
      WHERE s_ApplicationNo=@s_ApplicationNo  
      AND s_IpcCategory=@s_IPC 
      ]]>
    </commandText>
    <parameters>
      <param name="@s_ApplicationNo" dbType="AnsiStringFixedLength"  direction="Input"/>
      <param name="@s_IPC" dbType="AnsiStringFixedLength"  direction="Input"/>
    </parameters>
  </dataCommand>

  <!--更新申请号和分类号对应数据表 T_ApplyNoToIPC-->
  <dataCommand name="UpdatePCTApplicationByID" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
UPDATE [dbo].[T_PCTApplication]
   SET [s_ApplicationNo] = @s_ApplicationNo
      ,[s_ReceiveDate] = @s_ReceiveDate
      ,[d_Year] = @d_Year
      ,[d_Month] = @d_Month
      ,[s_IpcCategory] = @s_IpcCategory
      ,[s_ApplicantName]=@s_ApplicantName
      ,[s_ApplicantCountryCN] = @s_ApplicantCountryCN
      ,[s_ApplicantProvinceCN] = @s_ApplicantProvinceCN
      ,[s_ApplicantCityCN] = @s_ApplicantCityCN
      ,[s_ApplicantStreetCN] = @s_ApplicantStreetCN
      ,[s_ApplicantCityEN] = @s_ApplicantCityEN
      ,[s_ApplicantStreetEN] = @s_ApplicantStreetEN 
      ,[s_PatentName] = @s_PatentName 
      ,[s_ApplyDateWorld] = @s_ApplyDateWorld
      ,[d_ImportDate] = @d_ImportDate   
        WHERE n_ID=@n_ID 
          SELECT SCOPE_IDENTITY(); 
      ]]>
    </commandText>
    <parameters>
      <param name="@n_ID" dbType="Int64"  direction="Input"/>
      <param name="@s_ApplicationNo" dbType="String"  direction="Input"/>
      <param name="@s_ReceiveDate" dbType="String"  direction="Input"/>
      <param name="@d_Year" dbType="String"  direction="Input"/>
      <param name="@d_Month" dbType="String"  direction="Input"/>
      <param name="@s_IpcCategory" dbType="String"  direction="Input"/>
      <param name="@s_ApplicantName" dbType="String"  direction="Input"/>
      <!--<param name="@s_ApplicantSeq" dbType="String"  direction="Input"/>-->
      <param name="@s_ApplicantCountryCN" dbType="String"  direction="Input"/>
      <param name="@s_ApplicantProvinceCN" dbType="String"  direction="Input"/>
      <param name="@s_ApplicantCityCN" dbType="String"  direction="Input"/>
      <!--<param name="@s_ApplicantAreaCN" dbType="String"  direction="Input"/>-->
      <param name="@s_ApplicantStreetCN" dbType="String"  direction="Input"/>
      <!--<param name="@s_ApplicantCountryEN" dbType="String"  direction="Input"/>
      <param name="@s_ApplicantProvinceEN" dbType="String"  direction="Input"/>-->
      <param name="@s_ApplicantCityEN" dbType="String"  direction="Input"/>
      <!--<param name="@s_ApplicantAreaEN" dbType="String"  direction="Input"/>-->
      <param name="@s_ApplicantStreetEN" dbType="String"  direction="Input"/>
      <param name="@s_PatentName" dbType="String"  direction="Input"/>
      <param name="@s_ApplyDateWorld" dbType="String"  direction="Input"/>
      <param name="@d_ImportDate" dbType="String"  direction="Input"/>
    </parameters>
  </dataCommand>

  <!--插入申请号和分类号对应数据表 T_ApplyNoToIPC-->
  <dataCommand name="InsertApplyNoToIPC" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
INSERT INTO [dbo].[T_ApplyNoToIPC]
           ([s_ApplicationNO]
           ,[s_IpcCategory]
           ,[s_DataSource])
     VALUES
           (@s_Application_NO
           ,@s_IpcCategory
           ,@s_DataSource)
          SELECT SCOPE_IDENTITY();
      ]]>
    </commandText>
    <parameters>
      <param name="@s_Application_NO" dbType="String"  direction="Input"/>
      <param name="@s_IpcCategory" dbType="String"  direction="Input"/>
      <param name="@s_DataSource" dbType="Int32"  direction="Input"/>
    </parameters>
  </dataCommand>

  <!--更新申请号和分类号对应数据表 T_ApplyNoToIPC-->
  <dataCommand name="UpdateApplyNoToIPCByID" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
UPDATE [dbo].[T_ApplyNoToIPC]
   SET [s_ApplicationNO] = @s_Application_NO
      ,[s_IpcCategory] = @s_IpcCategory
      ,[s_DataSource] = @s_DataSource
        WHERE n_ID=@n_ID
          SELECT SCOPE_IDENTITY();
      ]]>
    </commandText>
    <parameters>
      <param name="@n_ID" dbType="Int64"  direction="Input"/>
      <param name="@s_Application_NO" dbType="String"  direction="Input"/>
      <param name="@s_IpcCategory" dbType="String"  direction="Input"/>
      <param name="@s_DataSource" dbType="Int32"  direction="Input"/>
    </parameters>
  </dataCommand>

  <!--校验数据表 T_ApplyNoToIPC-->
  <dataCommand name="CheckApplyNoToIPCExisted" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
SELECT  s_ApplicationNO 
  FROM  [dbo].[T_ApplyNoToIPC] WITH(NOLOCK)
      WHERE s_ApplicationNO=@s_Application_NO
      AND s_IpcCategory=@s_IpcCategory
      AND s_DataSource=@s_DataSource   
      ]]>
    </commandText>
    <parameters>
      <param name="@s_Application_NO" dbType="AnsiStringFixedLength" direction="Input"/>
      <param name="@s_IpcCategory" dbType="String"  direction="Input"/>
      <param name="@s_DataSource" dbType="Int32"  direction="Input"/>
    </parameters>
  </dataCommand>

  <!--查询SIPO有效数据表 T_SIPOEffectiveData-->
  <dataCommand name="GetSIPOEffectivesByQuery" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
    SELECT @TotalCount = COUNT(1)
   FROM  [dbo].[T_SIPOData] WITH(NOLOCK)
   #StrWhere# 
   
   IF EXISTS  (SELECT  * FROM dbo.SysObjects WHERE ID = object_id(N'[_TD]') AND OBJECTPROPERTY(ID, 'IsTable') = 1) 
   BEGIN
		    DROP TABLE _TD   
	 END
   
   SELECT RowNumber=ROW_NUMBER() OVER(ORDER BY A.n_ID DESC) 
				 ,A.n_ID  
	   INTO _TD
	   FROM T_SIPOData A 
       #StrWhere#   

CREATE NONCLUSTERED INDEX IX_TD_ROWNUM ON _TD(RowNumber)   

SELECT A.n_ID, 
      s_AreaCN, 
      d_Year,
      d_Month,
      n_Type,
      n_TotalCount,
      n_CurYearCount,
      n_CurMonthCount,
      n_PCount, 
      n_UCount, 
      n_DCount, 
      n_GRCount,
      n_DZCount,
      n_KYCount,
      n_QYCount,
      n_JGCount    
      FROM T_SIPOData A 
      inner join _TD TD on TD.n_ID=A.n_ID
WHERE RowNumber BETWEEN @StartNumber + 1 AND @EndNumber   

DROP TABLE _TD    

      ]]>
    </commandText>
  </dataCommand>

  <!--查询省份 -->
  <dataCommand name="GetGDPAProvinces" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
  SELECT 
      PROVINCE_ID, 
      PROVINCE_NAME,
      PROVINCE_CODE
      from dbo.T_AddrProvince 
      order by PROVINCE_ID 
      ]]>
    </commandText>
  </dataCommand>

  <!--查询城市 -->
  <dataCommand name="GetGDPACitys" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
  SELECT 
      PROVINCE_ID, 
      CITY_ID, 
      CITY_NAME ,CITY_CODE
      from dbo.T_AddrCity 
      WHERE PROVINCE_ID=@PROVINCE_ID  
      ]]>
    </commandText>
    <parameters>
      <param name="@PROVINCE_ID" dbType="Int32" direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="GetGDPACitysByPCode" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
  SELECT 
      C.*
      from dbo.T_AddrCity C
      left join T_AddrProvince P
      on C.PROVINCE_ID=P.PROVINCE_ID
      WHERE PROVINCE_CODE=@PROVINCE_CODE  
      ]]>
    </commandText>
    <parameters>
      <param name="@PROVINCE_CODE" dbType="Int32" direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="GetGDCitysExtShunde" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
            SELECT * FROM 
            (
            SELECT CITY_CODE id,CITY_NAME [text],ROW_NUMBER() OVER ( ORDER BY CITY_ID) I
            FROM T_AddrCity where PROVINCE_ID=5 AND CITY_CODE!=9999
            UNION
            SELECT AREA_CODE id,[text]='佛山市顺德区',I=9999 FROM T_AddrArea
            WHERE AREA_CODE=71
            ) TEMP
            ORDER BY I
      ]]>
    </commandText>
  </dataCommand>
  <dataCommand name="GetGDCityArea" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
            SELECT TCity.CITY_NAME,TCity.CITY_CODE,TArea.AREA_NAME,TArea.AREA_CODE FROM T_AddrArea TArea
            JOIN T_AddrCity TCity ON TCity.CITY_ID=TArea.CITY_ID
            WHERE TCity.PROVINCE_ID=5
            AND TCity.CITY_CODE!=9999
      ]]>
    </commandText>
  </dataCommand>
  <!--查询地区 -->
  <dataCommand name="GetGDPAAreas" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
  SELECT 
      AREA_ID, 
      PROVINCE_ID, 
      CITY_ID,
      AREA_NAME,
      AREA_CODE 
      from dbo.T_AddrArea 
      WHERE PROVINCE_ID=@PROVINCE_ID  
      ]]>
    </commandText>
    <parameters>
      <param name="@PROVINCE_ID" dbType="Int32" direction="Input"/>
      <param name="@CITY_ID" dbType="Int32" direction="Input"/>
    </parameters>
  </dataCommand>

  <!--查询街道 -->
  <dataCommand name="GetGDPAStreets" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
  SELECT 
      STREET_ID,
      PROVINCE_ID, 
      CITY_ID,
      AREA_ID,
      STREET_NAME,
      ZIPCODE,
      STREET_TYPE 
      from dbo.T_AddrStreet 
      WHERE PROVINCE_ID=@PROVINCE_ID  
      ]]>
    </commandText>
    <parameters>
      <param name="@PROVINCE_ID" dbType="Int32" direction="Input"/>
      <param name="@CITY_ID" dbType="Int32" direction="Input"/>
      <param name="@AREA_ID" dbType="Int32" direction="Input"/>
    </parameters>
  </dataCommand>

  <!--插入SIPO有效数据表 T_SIPOEffectiveData-->
  <dataCommand name="InsertSIPOEffective" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
    INSERT INTO  [dbo].[T_SIPOData] 
     (s_AreaCN, 
      d_Year,
      d_Month,
      dt_ImportDate,
      n_Type,
      n_TotalCount,
      n_CurYearCount,
      n_CurMonthCount,
      n_PCount, 
      n_UCount, 
      n_DCount, 
      n_GRCount, 
      n_DZCount, 
      n_KYCount, 
      n_QYCount, 
      n_JGCount,
      d_PCountPerMillion,
      n_PersonCount,
      n_ProvinceCode)
      VALUES 
      (@s_AreaCN 
           ,@d_Year 
           ,@d_Month 
           ,@dt_ImportDate
           ,@n_Type 
           ,@n_TotalCount 
           ,@n_CurYearCount 
           ,@n_CurMonthCount 
           ,@n_PCount 
           ,@n_UCount 
           ,@n_DCount 
           ,@n_GRCount 
           ,@n_DZCount 
           ,@n_KYCount
           ,@n_QYCount 
           ,@n_JGCount
           ,@d_PCountPerMillion
           ,@n_PersonCount
           ,@n_ProvinceCode) 
      SELECT SCOPE_IDENTITY();  
      ]]>
    </commandText>
    <parameters>
      <param name="@s_AreaCN" dbType="String"  direction="Input"/>
      <param name="@d_Year" dbType="String"  direction="Input"/>
      <param name="@d_Month" dbType="String"  direction="Input"/>
      <param name="@dt_ImportDate" dbType="DateTime"  direction="Input"/>
      <param name="@n_Type" dbType="Int32"  direction="Input"/>
      <param name="@n_TotalCount" dbType="Int64"  direction="Input"/>
      <param name="@n_CurYearCount" dbType="Int64"  direction="Input"/>
      <param name="@n_CurMonthCount" dbType="Int64"  direction="Input"/>
      <param name="@n_PCount" dbType="Int32"  direction="Input"/>
      <param name="@n_UCount" dbType="Int32"  direction="Input"/>
      <param name="@n_DCount" dbType="Int32"  direction="Input"/>
      <param name="@n_GRCount" dbType="Int32"  direction="Input"/>
      <param name="@n_DZCount" dbType="Int32"  direction="Input"/>
      <param name="@n_KYCount" dbType="Int32"  direction="Input"/>
      <param name="@n_QYCount" dbType="Int32"  direction="Input"/>
      <param name="@n_JGCount" dbType="Int32"  direction="Input"/>
      <param name="@d_PCountPerMillion" dbType="Int32"  direction="Input"/>
      <param name="@n_PersonCount" dbType="Double"  direction="Input"/>
      <param name="@n_ProvinceCode" dbType="Int32"  direction="Input"/>
    </parameters>
  </dataCommand>

  <!--更新SIPO有效数据表 T_SIPOEffectiveData-->
  <dataCommand name="UpdateSIPOEffectiveByID" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
    UPDATE  [dbo].[T_SIPOData]  
    SET [s_AreaCN]=@s_AreaCN, 
      [d_Year]=@d_Year,
      [d_Month]=@d_Month,
      [dt_ImportDate]=@dt_ImportDate,
      [n_Type]=@n_Type,
      [n_TotalCount]=@n_TotalCount,
      [n_CurYearCount]=@n_CurYearCount,
      [n_CurMonthCount]=@n_CurMonthCount,
      [n_PCount]=@n_PCount, 
      [n_UCount]=@n_UCount, 
      [n_DCount]=@n_DCount, 
      [n_GRCount]=@n_GRCount,
      [n_DZCount]=@n_DZCount,
      [n_KYCount]=@n_KYCount,
      [n_QYCount]=@n_QYCount,
      [n_JGCount]=@n_JGCount,
      [d_PCountPerMillion]=@d_PCountPerMillion,
      [n_PersonCount]=@n_PersonCount,
      [n_ProvinceCode]=@n_ProvinceCode   
      WHERE n_ID=@n_ID  
      SELECT SCOPE_IDENTITY();  
      ]]>
    </commandText>
    <parameters>
      <param name="@n_ID" dbType="Int64"  direction="Input"/>
      <param name="@s_AreaCN" dbType="String"  direction="Input"/>
      <param name="@d_Year" dbType="String"  direction="Input"/>
      <param name="@d_Month" dbType="String"  direction="Input"/>
      <param name="@dt_ImportDate" dbType="DateTime"  direction="Input"/>
      <param name="@n_Type" dbType="Int32"  direction="Input"/>
      <param name="@n_TotalCount" dbType="Int64"  direction="Input"/>
      <param name="@n_CurYearCount" dbType="Int64"  direction="Input"/>
      <param name="@n_CurMonthCount" dbType="Int64"  direction="Input"/>
      <param name="@n_PCount" dbType="Int32"  direction="Input"/>
      <param name="@n_UCount" dbType="Int32"  direction="Input"/>
      <param name="@n_DCount" dbType="Int32"  direction="Input"/>
      <param name="@n_GRCount" dbType="Int32"  direction="Input"/>
      <param name="@n_DZCount" dbType="Int32"  direction="Input"/>
      <param name="@n_KYCount" dbType="Int32"  direction="Input"/>
      <param name="@n_QYCount" dbType="Int32"  direction="Input"/>
      <param name="@n_JGCount" dbType="Int32"  direction="Input"/>
      <param name="@d_PCountPerMillion" dbType="Int32"  direction="Input"/>
      <param name="@n_PersonCount" dbType="Double"  direction="Input"/>
      <param name="@n_ProvinceCode" dbType="Int32"  direction="Input"/>
    </parameters>
  </dataCommand>

  <!--获取区域对应的ProvinceCode-->
  <dataCommand name="GetProvinceCodesByAreaCN" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
          select province.PROVINCE_CODE,city.CITY_NAME 
from dbo.T_AddrCity city 
inner join dbo.T_AddrProvince province on province.PROVINCE_ID=city.PROVINCE_ID 
      ]]>
    </commandText>
  </dataCommand>

  <!--根据id获取数据表 T_SIPOEffectiveData-->
  <dataCommand name="GetSIPOEffectiveById" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
  SELECT [n_ID], 
      [s_AreaCN], 
      [n_TotalCount],
      [n_PCount], 
      [n_UCount], 
      [n_DCount], 
      [n_PECount], 
      [n_PersonCount], 
      [n_UniversityCount], 
      [n_ResearchCount], 
      [n_EnterpriseCount], 
      [n_GovernmentCount] 
  FROM  [dbo].[T_SIPOEffectiveData] WITH(NOLOCK)
      WHERE n_ID=@n_ID 
      ]]>
    </commandText>
    <parameters>
      <param name="@n_ID" dbType="Int64"  direction="Input"/>
    </parameters>
  </dataCommand>

  <!--校验数据表 T_SIPOEffectiveData-->
  <dataCommand name="CheckSIPOEffectiveExisted" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
SELECT  COUNT(1) 
  FROM  [dbo].[T_SIPOEffectiveData] WITH(NOLOCK) 
      WHERE s_AreaCN=@s_AreaCN  
      ]]>
    </commandText>
    <parameters>
      <param name="@s_AreaCN" dbType="AnsiStringFixedLength" direction="Input"/>
    </parameters>
  </dataCommand>

  <!--根据地区获取数据表 T_SIPOEffectiveData-->
  <dataCommand name="GetGDPASIPOByAreaAndDate" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
  SELECT [n_ID]
      ,[s_AreaCN]
      ,[d_Year]
      ,[d_Month]
      ,[dt_ImportDate]
      ,[n_Type]
      ,[n_TotalCount]
      ,[n_CurYearCount]
      ,[n_CurMonthCount]
      ,[n_PCount]
      ,[n_UCount]
      ,[n_DCount]
      ,[n_GRCount]
      ,[n_DZCount]
      ,[n_KYCount]
      ,[n_QYCount]
      ,[n_JGCount]
      ,[n_ProvinceCode]   
  FROM  [dbo].[T_SIPOData] WITH(NOLOCK)
      WHERE s_AreaCN=@s_AreaCN
      AND d_Year=@s_Year
      AND d_Month=@s_Month 
      AND n_Type=@n_Type   
      ]]>
    </commandText>
    <parameters>
      <param name="@s_AreaCN" dbType="AnsiStringFixedLength"  direction="Input"/>
      <param name="@s_Year" dbType="AnsiStringFixedLength"  direction="Input"/>
      <param name="@s_Month" dbType="AnsiStringFixedLength"  direction="Input"/>
      <param name="@n_Type" dbType="AnsiStringFixedLength"  direction="Input"/>
    </parameters>
  </dataCommand>

  <!--根据id获取IPC数据表 T_IPCLocarno-->
  <dataCommand name="GetIPCById" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
  SELECT [n_ID], 
      [s_ApplicationNo], 
      [s_IpcCategory] 
  FROM  [dbo].[T_IPCLocarno] WITH(NOLOCK)
      WHERE n_ID=@n_ID 
      ]]>
    </commandText>
    <parameters>
      <param name="@n_ID" dbType="Int64"  direction="Input"/>
    </parameters>
  </dataCommand>

  <!--根据申请号获取IPC数据 T_IPCLocarno-->
  <dataCommand name="GetGDPAIPCByAppAndIPCNo" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
  SELECT [n_ID], 
      [s_ApplicationNo], 
      [s_IpcCategory] 
  FROM  [dbo].[T_IPCLocarno] WITH(NOLOCK)
      WHERE s_ApplicationNo=@s_ApplicationNo 
      AND s_IpcCategory=@s_IpcCategory 
      ]]>
    </commandText>
    <parameters>
      <param name="@s_ApplicationNo" dbType="AnsiStringFixedLength"  direction="Input"/>
      <param name="@s_IpcCategory" dbType="AnsiStringFixedLength"  direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="GetGDPAIPCByAppAndIPCNo2" database="MDATA2" commandType="Text">
    <commandText>
      <![CDATA[ 
  SELECT [n_ID], 
      [s_ApplicationNo], 
      [s_IpcCategory] 
  FROM  [dbo].[T_IPCLocarno] WITH(NOLOCK)
      WHERE s_ApplicationNo=@s_ApplicationNo 
      AND s_IpcCategory=@s_IpcCategory 
      ]]>
    </commandText>
    <parameters>
      <param name="@s_ApplicationNo" dbType="AnsiStringFixedLength"  direction="Input"/>
      <param name="@s_IpcCategory" dbType="AnsiStringFixedLength"  direction="Input"/>
    </parameters>
  </dataCommand>

  <!--根据申请号校验数据表 T_IPCLocarno-->
  <dataCommand name="CheckIPCExisted" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
SELECT  COUNT(1) 
  FROM  [dbo].[T_IPCLocarno] WITH(NOLOCK) 
      WHERE s_ApplicationNo=@s_ApplicationNo  
      ]]>
    </commandText>
    <parameters>
      <param name="@s_ApplicationNo" dbType="AnsiStringFixedLength" direction="Input"/>
    </parameters>
  </dataCommand>

  <!--查询IPC数据表 T_IPCLocarno-->
  <dataCommand name="GetIPCsByQuery" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
    SELECT @TotalCount = COUNT(1)
   FROM  [dbo].[T_IPCLocarno] WITH(NOLOCK)
   #StrWhere# 
 SELECT 
      RowNumber, 
      n_ID, 
      s_ApplicationNo, 
      s_IpcCategory 
      FROM ( 
 SELECT TOP (@EndNumber) RowNumber=ROW_NUMBER() OVER(ORDER BY #SortColumnName#)
      ,n_ID, 
      s_ApplicationNo, 
      s_IpcCategory  
      from dbo.T_IPCLocarno 
      #StrWhere#
    ) R
  WHERE
     RowNumber>@StartNumber
      ]]>
    </commandText>
  </dataCommand>

  <!--插入IPC数据表 T_IPCLocarno-->
  <dataCommand name="InsertIPC" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
INSERT INTO [dbo].[T_IPCLocarno]
           ([s_ApplicationNo]
           ,[s_IpcCategory])
     VALUES
           (@s_ApplicationNo
           ,@s_IpcCategory)
          SELECT SCOPE_IDENTITY();
      ]]>
    </commandText>
    <parameters>
      <param name="@s_ApplicationNo" dbType="String"  direction="Input"/>
      <param name="@s_IpcCategory" dbType="String"  direction="Input"/>
    </parameters>
  </dataCommand>
  <dataCommand name="InsertIPC2" database="MDATA2" commandType="Text">
    <commandText>
      <![CDATA[ 
INSERT INTO [dbo].[T_IPCLocarno]
           ([s_ApplicationNo]
           ,[s_IpcCategory])
     VALUES
           (@s_ApplicationNo
           ,@s_IpcCategory)
          SELECT SCOPE_IDENTITY();
      ]]>
    </commandText>
    <parameters>
      <param name="@s_ApplicationNo" dbType="String"  direction="Input"/>
      <param name="@s_IpcCategory" dbType="String"  direction="Input"/>
    </parameters>
  </dataCommand>

  <!--更新IPC数据表 T_IPCLocarno-->
  <dataCommand name="UpdateIPCByID" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
UPDATE [dbo].[T_IPCLocarno]
   SET [s_ApplicationNo] = @s_ApplicationNo
      ,[s_IpcCategory] = @s_IpcCategory 
        WHERE n_ID=@n_ID
          SELECT SCOPE_IDENTITY(); 
      ]]>
    </commandText>
    <parameters>
      <param name="@n_ID" dbType="Int64"  direction="Input"/>
      <param name="@s_ApplicationNo" dbType="String"  direction="Input"/>
      <param name="@s_IpcCategory" dbType="String"  direction="Input"/>
    </parameters>
  </dataCommand>

  <!--删除IPC数据表 T_IPCLocarno-->
  <dataCommand name="DeleteIPCByID" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
DELETE [dbo].[T_IPCLocarno]
        WHERE n_ID=@n_ID 
      ]]>
    </commandText>
    <parameters>
      <param name="@n_ID" dbType="Int64"  direction="Input"/>
    </parameters>
  </dataCommand>

  <!--广东省地级市电子申请率排名报表-->
  <dataCommand name="GetGDPAElectronicData" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
      select n_CityCode,SUM(f_Count) as City_Count 
into #Elec
from T_PatentChartApplyData
where n_ProvinceCode=5
group by n_CityCode 

select s_Area,s_Rate,ROW_NUMBER() over (order by s_Rate desc) as n_No from 
(
select CITY_NAME as s_Area,e.City_Count,Round(100*(SUM(p.f_Count)/Cast((case when e.City_Count=0 then 1 else e.City_Count end) as float)),2) as s_Rate
from T_PatentChartApplyData as p
inner join dbo.T_AddrCity on CITY_ID=p.n_CityCode 
inner join #Elec as e on e.n_CityCode=p.n_CityCode
where p.b_ElectronicTF=1
and p.n_ProvinceCode=5
group by CITY_NAME,e.City_Count
) TMP 

drop table #Elec 
      ]]>
    </commandText>

  </dataCommand>

  <!--广东省地级市有效发明专利情况表-->
  <dataCommand name="GetGDPAEffectiveData" database="MDATA" commandType="Text">
    <commandText>
      <![CDATA[ 
      declare @ProvinceCount int
select @ProvinceCount=SUM(f_Count)
from T_PatentChartApplyData
where n_ProvinceCode=5
and n_PatentStatus=2

select s_Area,n_No,s_Rate from 
(
select CITY_NAME as s_Area,SUM(p.f_Count) as n_No,Round(100*(SUM(p.f_Count)/Cast((case when @ProvinceCount=0 then 1 else @ProvinceCount end) as float)),2) as s_Rate
from T_PatentChartApplyData as p
inner join dbo.T_AddrCity on CITY_ID=p.n_CityCode 
where p.n_PatentStatus=2
and p.n_ProvinceCode=5
group by CITY_NAME
) TMP  
      ]]>
    </commandText>

  </dataCommand>

</dataOperations>
